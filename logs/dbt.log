[0m13:50:59.553488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff258a94820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff256b6cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff256b6cc10>]}


============================== 13:50:59.619677 | cba342b6-5162-48e6-9b85-d4dd23cf9074 ==============================
[0m13:50:59.619677 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:50:59.620719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt init', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:51:37.962948 [debug] [MainThread]: Starter project path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/lib/python3.10/site-packages/dbt/include/starter_project
[0m13:51:37.985389 [info ] [MainThread]: 
Your new dbt project "data_challenge_dbt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:51:37.986329 [info ] [MainThread]: Setting up your profile.
[0m13:53:19.980867 [info ] [MainThread]: Profile data_challenge_dbt written to /home/agustin/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:53:19.983228 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 140.59515, "process_user_time": 5.980029, "process_kernel_time": 0.35624, "process_mem_max_rss": "97212", "process_in_blocks": "34088", "process_out_blocks": "21392"}
[0m13:53:19.984530 [debug] [MainThread]: Command `dbt init` succeeded at 13:53:19.984223 after 140.60 seconds
[0m13:53:19.985793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff258a94820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2572a6da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff256c10880>]}
[0m13:53:19.986809 [debug] [MainThread]: Flushing usage events
[0m14:02:44.509830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10cc397640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ca689c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ca689c30>]}


============================== 14:02:44.514323 | 563edbda-aaca-4252-8ec0-a1c72985d33f ==============================
[0m14:02:44.514323 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:02:44.515327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:02:44.516337 [info ] [MainThread]: dbt version: 1.7.4
[0m14:02:44.517089 [info ] [MainThread]: python version: 3.10.12
[0m14:02:44.517810 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m14:02:44.518522 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m14:02:44.676970 [info ] [MainThread]: Using profiles dir at /home/agustin/.dbt
[0m14:02:44.677856 [info ] [MainThread]: Using profiles.yml file at /home/agustin/.dbt/profiles.yml
[0m14:02:44.678594 [info ] [MainThread]: Using dbt_project.yml file at /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m14:02:44.679434 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m14:02:44.680930 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.2516797, "process_user_time": 3.591925, "process_kernel_time": 0.164179, "process_mem_max_rss": "94328", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m14:02:44.682026 [debug] [MainThread]: Command `dbt debug` failed at 14:02:44.681749 after 0.25 seconds
[0m14:02:44.682777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10cc397640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ca566d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ca689de0>]}
[0m14:02:44.683549 [debug] [MainThread]: Flushing usage events
[0m19:36:27.302965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f2595510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f094dc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f094dba0>]}


============================== 19:36:27.319885 | 6c50895b-2d78-4ea8-8dc2-0306a2ec80f9 ==============================
[0m19:36:27.319885 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:36:27.321065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/home/agustin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:27.322054 [info ] [MainThread]: dbt version: 1.7.4
[0m19:36:27.322802 [info ] [MainThread]: python version: 3.10.12
[0m19:36:27.323559 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m19:36:27.324289 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m19:36:28.129992 [info ] [MainThread]: Using profiles dir at /home/agustin/.dbt
[0m19:36:28.130990 [info ] [MainThread]: Using profiles.yml file at /home/agustin/.dbt/profiles.yml
[0m19:36:28.132022 [info ] [MainThread]: Using dbt_project.yml file at /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m19:36:28.132924 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m19:36:28.134412 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.9297541, "process_user_time": 4.357525, "process_kernel_time": 0.28139, "process_mem_max_rss": "94332", "process_in_blocks": "43344", "process_out_blocks": "8", "command_success": false}
[0m19:36:28.135603 [debug] [MainThread]: Command `dbt debug` failed at 19:36:28.135309 after 0.93 seconds
[0m19:36:28.136363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f2595510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f082ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44f094dd50>]}
[0m19:36:28.137158 [debug] [MainThread]: Flushing usage events
[0m12:51:38.796623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29a3ab5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2986107c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff298610760>]}


============================== 12:51:38.831965 | 5d88ef75-0ef3-40c7-a785-6e2a479a44a1 ==============================
[0m12:51:38.831965 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:51:38.833223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:38.834277 [info ] [MainThread]: dbt version: 1.7.4
[0m12:51:38.835122 [info ] [MainThread]: python version: 3.10.12
[0m12:51:38.835939 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m12:51:38.836752 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m12:51:38.838065 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 31
  ------------------------------
  28 |       type: postgres
  29 |       user: postgres-user
  30 |   target: dev
  31 | """
  32 | 
  33 | 
  34 | """
  
  Raw Error:
  ------------------------------
  while scanning a simple key
    in "<unicode string>", line 18, column 1
  could not find expected ':'
    in "<unicode string>", line 31, column 2
[0m12:51:38.839639 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.046867035, "process_user_time": 3.382942, "process_kernel_time": 0.131958, "process_mem_max_rss": "88616", "process_in_blocks": "8", "process_out_blocks": "8", "command_success": false}
[0m12:51:38.840768 [debug] [MainThread]: Command `dbt debug` failed at 12:51:38.840484 after 0.05 seconds
[0m12:51:38.841672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29a3ab5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2986107c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff298610a00>]}
[0m12:51:38.842492 [debug] [MainThread]: Flushing usage events
[0m12:53:38.140683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ed45510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6cd95c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6cd95ba0>]}


============================== 12:53:38.145153 | 676aa931-be10-4c09-b277-73e4bcc5e2e2 ==============================
[0m12:53:38.145153 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:53:38.146350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:38.147364 [info ] [MainThread]: dbt version: 1.7.4
[0m12:53:38.148177 [info ] [MainThread]: python version: 3.10.12
[0m12:53:38.148967 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m12:53:38.149766 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m12:53:38.967464 [info ] [MainThread]: Using profiles dir at /home/agustin/.dbt
[0m12:53:38.968467 [info ] [MainThread]: Using profiles.yml file at /home/agustin/.dbt/profiles.yml
[0m12:53:38.969370 [info ] [MainThread]: Using dbt_project.yml file at /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m12:53:38.971174 [info ] [MainThread]: adapter type: postgres
[0m12:53:38.972284 [info ] [MainThread]: adapter version: 1.7.4
[0m12:53:38.973099 [info ] [MainThread]: Configuration:
[0m12:53:38.973905 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:53:38.974675 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:53:38.975433 [info ] [MainThread]: Required dependencies:
[0m12:53:38.976230 [debug] [MainThread]: Executing "git --help"
[0m12:53:39.002672 [debug] [MainThread]: STDOUT: "b"uso: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nEstos son comandos comunes de Git usados en varias situaciones:\n\ncomenzar un \xc3\xa1rea de trabajo (mira tambi\xc3\xa9n: git help tutorial)\n   clone     Clonar un repositorio dentro de un nuevo directorio\n   init      Crear un repositorio de Git vac\xc3\xado o reinicia el que ya existe\n\ntrabajar en los cambios actuales (mira tambi\xc3\xa9n: git help everyday)\n   add       Agregar contenido de archivos al \xc3\xadndice\n   mv        Mover o cambiar el nombre a archivos, directorios o enlaces simb\xc3\xb3licos\n   restore   Restaurar archivos del \xc3\xa1rbol de trabajo\n   rm        Borrar archivos del \xc3\xa1rbol de trabajo y del \xc3\xadndice\n\nexaminar el historial y el estado (mira tambi\xc3\xa9n: git help revisions)\n   bisect    Usar la b\xc3\xbasqueda binaria para encontrar el commit que introdujo el bug\n   diff      Mostrar los cambios entre commits, commit y \xc3\xa1rbol de trabajo, etc\n   grep      Imprimir las l\xc3\xadneas que concuerden con el patr\xc3\xb3n\n   log       Mostrar los logs de los commits\n   show      Mostrar varios tipos de objetos\n   status    Mostrar el estado del \xc3\xa1rbol de trabajo\n\ncrecer, marcar y ajustar tu historial com\xc3\xban\n   branch    Listar, crear, o borrar ramas\n   commit    Grabar los cambios al repositorio\n   merge     Juntar dos o m\xc3\xa1s historiales de desarrollo juntos\n   rebase    Volver a aplicar commits en la punta de otra rama\n   reset     Reiniciar el HEAD actual a un estado espec\xc3\xadfico\n   switch    Cambiar de branch\n   tag       Crear, listar, borrar o verificar un objeto de tag firmado con GPG\n\ncolaborar (mira tambi\xc3\xa9n: git help workflows)\n   fetch     Descargar objetos y referencias de otro repositorio\n   pull      Realizar un fetch e integra con otro repositorio o rama local\n   push      Actualizar referencias remotas junto con sus objetos asociados\n\n'git help -a' y 'git help -g' listan los subcomandos disponibles y algunas\ngu\xc3\xadas de concepto. Consulta 'git help <command>' o 'git help <concepto>'\npara leer sobre un subcomando o concepto espec\xc3\xadfico.\nMira 'git help git' para una vista general del sistema.\n""
[0m12:53:39.003917 [debug] [MainThread]: STDERR: "b''"
[0m12:53:39.004671 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:53:39.005513 [info ] [MainThread]: Connection:
[0m12:53:39.006360 [info ] [MainThread]:   host: localhost
[0m12:53:39.007201 [info ] [MainThread]:   port: 5432
[0m12:53:39.007949 [info ] [MainThread]:   user: postgres
[0m12:53:39.008667 [info ] [MainThread]:   database: data-challenge-dbt
[0m12:53:39.009379 [info ] [MainThread]:   schema: public
[0m12:53:39.010113 [info ] [MainThread]:   connect_timeout: 10
[0m12:53:39.010829 [info ] [MainThread]:   role: None
[0m12:53:39.011535 [info ] [MainThread]:   search_path: None
[0m12:53:39.012244 [info ] [MainThread]:   keepalives_idle: 0
[0m12:53:39.012952 [info ] [MainThread]:   sslmode: None
[0m12:53:39.013739 [info ] [MainThread]:   sslcert: None
[0m12:53:39.014580 [info ] [MainThread]:   sslkey: None
[0m12:53:39.015290 [info ] [MainThread]:   sslrootcert: None
[0m12:53:39.016003 [info ] [MainThread]:   application_name: dbt
[0m12:53:39.016714 [info ] [MainThread]:   retries: 1
[0m12:53:39.017605 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m12:53:39.018736 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:53:39.019473 [debug] [MainThread]: Using postgres connection "debug"
[0m12:53:39.020145 [debug] [MainThread]: On debug: select 1 as id
[0m12:53:39.020804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:39.326787 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:53:39.330810 [debug] [MainThread]: On debug: Close
[0m12:53:39.332869 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:53:39.335062 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:53:39.337319 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/agustin/Documentos/data-challenge-dbt/dbt_project.yml> not found

[0m12:53:39.341299 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.2807727, "process_user_time": 3.653101, "process_kernel_time": 0.218867, "process_mem_max_rss": "96624", "process_in_blocks": "13024", "process_out_blocks": "32", "command_success": false}
[0m12:53:39.344205 [debug] [MainThread]: Command `dbt debug` failed at 12:53:39.343520 after 1.28 seconds
[0m12:53:39.346075 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:53:39.348247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ed45510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6cc735e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6cc709a0>]}
[0m12:53:39.350321 [debug] [MainThread]: Flushing usage events
[0m13:05:34.863434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ddb99510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42dbe89c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42dbe89c00>]}


============================== 13:05:34.867907 | f6449f60-37d8-452b-bb86-cb736ebce442 ==============================
[0m13:05:34.867907 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:05:34.869039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/agustin/.dbt', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:34.869992 [info ] [MainThread]: dbt version: 1.7.4
[0m13:05:34.870773 [info ] [MainThread]: python version: 3.10.12
[0m13:05:34.871523 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m13:05:34.872274 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m13:05:35.027342 [info ] [MainThread]: Using profiles dir at /home/agustin/.dbt
[0m13:05:35.028288 [info ] [MainThread]: Using profiles.yml file at /home/agustin/.dbt/profiles.yml
[0m13:05:35.029068 [info ] [MainThread]: Using dbt_project.yml file at /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m13:05:35.030192 [info ] [MainThread]: adapter type: postgres
[0m13:05:35.031133 [info ] [MainThread]: adapter version: 1.7.4
[0m13:05:35.187682 [info ] [MainThread]: Configuration:
[0m13:05:35.188601 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:05:35.189364 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:05:35.190140 [info ] [MainThread]: Required dependencies:
[0m13:05:35.190916 [debug] [MainThread]: Executing "git --help"
[0m13:05:35.194921 [debug] [MainThread]: STDOUT: "b"uso: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nEstos son comandos comunes de Git usados en varias situaciones:\n\ncomenzar un \xc3\xa1rea de trabajo (mira tambi\xc3\xa9n: git help tutorial)\n   clone     Clonar un repositorio dentro de un nuevo directorio\n   init      Crear un repositorio de Git vac\xc3\xado o reinicia el que ya existe\n\ntrabajar en los cambios actuales (mira tambi\xc3\xa9n: git help everyday)\n   add       Agregar contenido de archivos al \xc3\xadndice\n   mv        Mover o cambiar el nombre a archivos, directorios o enlaces simb\xc3\xb3licos\n   restore   Restaurar archivos del \xc3\xa1rbol de trabajo\n   rm        Borrar archivos del \xc3\xa1rbol de trabajo y del \xc3\xadndice\n\nexaminar el historial y el estado (mira tambi\xc3\xa9n: git help revisions)\n   bisect    Usar la b\xc3\xbasqueda binaria para encontrar el commit que introdujo el bug\n   diff      Mostrar los cambios entre commits, commit y \xc3\xa1rbol de trabajo, etc\n   grep      Imprimir las l\xc3\xadneas que concuerden con el patr\xc3\xb3n\n   log       Mostrar los logs de los commits\n   show      Mostrar varios tipos de objetos\n   status    Mostrar el estado del \xc3\xa1rbol de trabajo\n\ncrecer, marcar y ajustar tu historial com\xc3\xban\n   branch    Listar, crear, o borrar ramas\n   commit    Grabar los cambios al repositorio\n   merge     Juntar dos o m\xc3\xa1s historiales de desarrollo juntos\n   rebase    Volver a aplicar commits en la punta de otra rama\n   reset     Reiniciar el HEAD actual a un estado espec\xc3\xadfico\n   switch    Cambiar de branch\n   tag       Crear, listar, borrar o verificar un objeto de tag firmado con GPG\n\ncolaborar (mira tambi\xc3\xa9n: git help workflows)\n   fetch     Descargar objetos y referencias de otro repositorio\n   pull      Realizar un fetch e integra con otro repositorio o rama local\n   push      Actualizar referencias remotas junto con sus objetos asociados\n\n'git help -a' y 'git help -g' listan los subcomandos disponibles y algunas\ngu\xc3\xadas de concepto. Consulta 'git help <command>' o 'git help <concepto>'\npara leer sobre un subcomando o concepto espec\xc3\xadfico.\nMira 'git help git' para una vista general del sistema.\n""
[0m13:05:35.195925 [debug] [MainThread]: STDERR: "b''"
[0m13:05:35.196612 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:05:35.197360 [info ] [MainThread]: Connection:
[0m13:05:35.198147 [info ] [MainThread]:   host: localhost
[0m13:05:35.198976 [info ] [MainThread]:   port: 5432
[0m13:05:35.200012 [info ] [MainThread]:   user: postgres
[0m13:05:35.201058 [info ] [MainThread]:   database: data-challenge-dbt
[0m13:05:35.201883 [info ] [MainThread]:   schema: public
[0m13:05:35.202621 [info ] [MainThread]:   connect_timeout: 10
[0m13:05:35.203354 [info ] [MainThread]:   role: None
[0m13:05:35.204137 [info ] [MainThread]:   search_path: None
[0m13:05:35.205174 [info ] [MainThread]:   keepalives_idle: 0
[0m13:05:35.206210 [info ] [MainThread]:   sslmode: None
[0m13:05:35.207004 [info ] [MainThread]:   sslcert: None
[0m13:05:35.207771 [info ] [MainThread]:   sslkey: None
[0m13:05:35.208660 [info ] [MainThread]:   sslrootcert: None
[0m13:05:35.209552 [info ] [MainThread]:   application_name: dbt
[0m13:05:35.210353 [info ] [MainThread]:   retries: 1
[0m13:05:35.211253 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:05:35.212627 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:05:35.213782 [debug] [MainThread]: Using postgres connection "debug"
[0m13:05:35.214556 [debug] [MainThread]: On debug: select 1 as id
[0m13:05:35.215426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:35.232215 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:05:35.234268 [debug] [MainThread]: On debug: Close
[0m13:05:35.235302 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:05:35.236815 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:05:35.239505 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.45614278, "process_user_time": 3.820246, "process_kernel_time": 0.116864, "process_mem_max_rss": "97784", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m13:05:35.241350 [debug] [MainThread]: Command `dbt debug` succeeded at 13:05:35.240911 after 0.46 seconds
[0m13:05:35.242600 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:05:35.243899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ddb99510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42dbe89ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42db74df00>]}
[0m13:05:35.245258 [debug] [MainThread]: Flushing usage events
[0m13:05:44.405943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa933ab640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9169de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9169ddb0>]}


============================== 13:05:44.410440 | 3ceca845-cde0-4a62-a6f8-4f4d2031c9de ==============================
[0m13:05:44.410440 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:05:44.411595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/agustin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:44.747861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ceca845-cde0-4a62-a6f8-4f4d2031c9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9205c4c0>]}
[0m13:05:44.919557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ceca845-cde0-4a62-a6f8-4f4d2031c9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa915276a0>]}
[0m13:05:44.920914 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:05:44.963446 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:05:44.964605 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:05:44.965462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ceca845-cde0-4a62-a6f8-4f4d2031c9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa90b0c100>]}
[0m13:05:46.289240 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_challenge_dbt.example
- models.data_challenge_dbt.challenge
[0m13:05:46.297936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ceca845-cde0-4a62-a6f8-4f4d2031c9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa955c0580>]}
[0m13:05:46.311222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ceca845-cde0-4a62-a6f8-4f4d2031c9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa907b2050>]}
[0m13:05:46.312273 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:05:46.313103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ceca845-cde0-4a62-a6f8-4f4d2031c9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa907d32b0>]}
[0m13:05:46.314981 [info ] [MainThread]: 
[0m13:05:46.315791 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:05:46.317026 [debug] [MainThread]: Command end result
[0m13:05:46.331231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.006034, "process_user_time": 5.251119, "process_kernel_time": 0.168485, "process_mem_max_rss": "101508", "process_in_blocks": "1312", "process_out_blocks": "2272"}
[0m13:05:46.332402 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:46.332124 after 2.01 seconds
[0m13:05:46.333190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa933ab640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa955c1a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9205c520>]}
[0m13:05:46.334022 [debug] [MainThread]: Flushing usage events
[0m13:12:23.301419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bab53c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b8b8dd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b8b8dd20>]}


============================== 13:12:23.305885 | a632318a-75ee-41f1-9251-1d5e69dc01d7 ==============================
[0m13:12:23.305885 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:12:23.307039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/agustin/.dbt', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:12:23.308012 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:12:23.309506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.08826298, "process_user_time": 3.420065, "process_kernel_time": 0.167806, "process_mem_max_rss": "89468", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m13:12:23.310647 [debug] [MainThread]: Command `dbt run` failed at 13:12:23.310366 after 0.09 seconds
[0m13:12:23.311402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bab53c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b8b8de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b8b8dcf0>]}
[0m13:12:23.312178 [debug] [MainThread]: Flushing usage events
[0m13:13:12.460507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93da197640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8549c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8549c30>]}


============================== 13:13:12.465079 | 1945c727-02bb-4f0b-b434-f28682e51691 ==============================
[0m13:13:12.465079 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:13:12.466240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:13:12.467277 [info ] [MainThread]: dbt version: 1.7.4
[0m13:13:12.468044 [info ] [MainThread]: python version: 3.10.12
[0m13:13:12.468803 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m13:13:12.469671 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m13:13:12.625177 [info ] [MainThread]: Using profiles dir at /home/agustin/.dbt
[0m13:13:12.626163 [info ] [MainThread]: Using profiles.yml file at /home/agustin/.dbt/profiles.yml
[0m13:13:12.626973 [info ] [MainThread]: Using dbt_project.yml file at /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m13:13:12.628069 [info ] [MainThread]: adapter type: postgres
[0m13:13:12.628865 [info ] [MainThread]: adapter version: 1.7.4
[0m13:13:12.629694 [info ] [MainThread]: Configuration:
[0m13:13:12.630492 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:12.631264 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m13:13:12.632024 [info ] [MainThread]: Required dependencies:
[0m13:13:12.632815 [debug] [MainThread]: Executing "git --help"
[0m13:13:12.636938 [debug] [MainThread]: STDOUT: "b"uso: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nEstos son comandos comunes de Git usados en varias situaciones:\n\ncomenzar un \xc3\xa1rea de trabajo (mira tambi\xc3\xa9n: git help tutorial)\n   clone     Clonar un repositorio dentro de un nuevo directorio\n   init      Crear un repositorio de Git vac\xc3\xado o reinicia el que ya existe\n\ntrabajar en los cambios actuales (mira tambi\xc3\xa9n: git help everyday)\n   add       Agregar contenido de archivos al \xc3\xadndice\n   mv        Mover o cambiar el nombre a archivos, directorios o enlaces simb\xc3\xb3licos\n   restore   Restaurar archivos del \xc3\xa1rbol de trabajo\n   rm        Borrar archivos del \xc3\xa1rbol de trabajo y del \xc3\xadndice\n\nexaminar el historial y el estado (mira tambi\xc3\xa9n: git help revisions)\n   bisect    Usar la b\xc3\xbasqueda binaria para encontrar el commit que introdujo el bug\n   diff      Mostrar los cambios entre commits, commit y \xc3\xa1rbol de trabajo, etc\n   grep      Imprimir las l\xc3\xadneas que concuerden con el patr\xc3\xb3n\n   log       Mostrar los logs de los commits\n   show      Mostrar varios tipos de objetos\n   status    Mostrar el estado del \xc3\xa1rbol de trabajo\n\ncrecer, marcar y ajustar tu historial com\xc3\xban\n   branch    Listar, crear, o borrar ramas\n   commit    Grabar los cambios al repositorio\n   merge     Juntar dos o m\xc3\xa1s historiales de desarrollo juntos\n   rebase    Volver a aplicar commits en la punta de otra rama\n   reset     Reiniciar el HEAD actual a un estado espec\xc3\xadfico\n   switch    Cambiar de branch\n   tag       Crear, listar, borrar o verificar un objeto de tag firmado con GPG\n\ncolaborar (mira tambi\xc3\xa9n: git help workflows)\n   fetch     Descargar objetos y referencias de otro repositorio\n   pull      Realizar un fetch e integra con otro repositorio o rama local\n   push      Actualizar referencias remotas junto con sus objetos asociados\n\n'git help -a' y 'git help -g' listan los subcomandos disponibles y algunas\ngu\xc3\xadas de concepto. Consulta 'git help <command>' o 'git help <concepto>'\npara leer sobre un subcomando o concepto espec\xc3\xadfico.\nMira 'git help git' para una vista general del sistema.\n""
[0m13:13:12.638450 [debug] [MainThread]: STDERR: "b''"
[0m13:13:12.639374 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:12.640153 [info ] [MainThread]: Connection:
[0m13:13:12.640922 [info ] [MainThread]:   host: localhost
[0m13:13:12.641715 [info ] [MainThread]:   port: 5432
[0m13:13:12.642456 [info ] [MainThread]:   user: postgres
[0m13:13:12.643183 [info ] [MainThread]:   database: data-challenge-dbt
[0m13:13:12.643899 [info ] [MainThread]:   schema: public
[0m13:13:12.644620 [info ] [MainThread]:   connect_timeout: 10
[0m13:13:12.645339 [info ] [MainThread]:   role: None
[0m13:13:12.646084 [info ] [MainThread]:   search_path: None
[0m13:13:12.646802 [info ] [MainThread]:   keepalives_idle: 0
[0m13:13:12.647514 [info ] [MainThread]:   sslmode: None
[0m13:13:12.648224 [info ] [MainThread]:   sslcert: None
[0m13:13:12.648963 [info ] [MainThread]:   sslkey: None
[0m13:13:12.649722 [info ] [MainThread]:   sslrootcert: None
[0m13:13:12.650441 [info ] [MainThread]:   application_name: dbt
[0m13:13:12.651150 [info ] [MainThread]:   retries: 1
[0m13:13:12.651981 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:13:12.653345 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:13:12.654237 [debug] [MainThread]: Using postgres connection "debug"
[0m13:13:12.654922 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:12.655634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:12.671983 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:13:12.674353 [debug] [MainThread]: On debug: Close
[0m13:13:12.675332 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:12.676256 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:13:12.677137 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/agustin/Documentos/data-challenge-dbt/dbt_project.yml> not found

[0m13:13:12.679190 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.3004652, "process_user_time": 3.657255, "process_kernel_time": 0.175868, "process_mem_max_rss": "96700", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m13:13:12.680382 [debug] [MainThread]: Command `dbt debug` failed at 13:13:12.680097 after 0.30 seconds
[0m13:13:12.681127 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:12.681922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93da197640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d841e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d841f6a0>]}
[0m13:13:12.682759 [debug] [MainThread]: Flushing usage events
[0m13:13:56.340081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4451d97c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445008dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f445008dc00>]}


============================== 13:13:56.344533 | f4ca1fa4-181a-4dca-8a35-8123904cf3ef ==============================
[0m13:13:56.344533 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:13:56.345800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:56.346878 [info ] [MainThread]: dbt version: 1.7.4
[0m13:13:56.347775 [info ] [MainThread]: python version: 3.10.12
[0m13:13:56.348873 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m13:13:56.349670 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m13:13:56.505464 [info ] [MainThread]: Using profiles dir at /home/agustin/.dbt
[0m13:13:56.506412 [info ] [MainThread]: Using profiles.yml file at /home/agustin/.dbt/profiles.yml
[0m13:13:56.507187 [info ] [MainThread]: Using dbt_project.yml file at /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m13:13:56.508299 [info ] [MainThread]: adapter type: postgres
[0m13:13:56.509097 [info ] [MainThread]: adapter version: 1.7.4
[0m13:13:56.509910 [info ] [MainThread]: Configuration:
[0m13:13:56.510667 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:56.511411 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m13:13:56.512157 [info ] [MainThread]: Required dependencies:
[0m13:13:56.512966 [debug] [MainThread]: Executing "git --help"
[0m13:13:56.517056 [debug] [MainThread]: STDOUT: "b"uso: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nEstos son comandos comunes de Git usados en varias situaciones:\n\ncomenzar un \xc3\xa1rea de trabajo (mira tambi\xc3\xa9n: git help tutorial)\n   clone     Clonar un repositorio dentro de un nuevo directorio\n   init      Crear un repositorio de Git vac\xc3\xado o reinicia el que ya existe\n\ntrabajar en los cambios actuales (mira tambi\xc3\xa9n: git help everyday)\n   add       Agregar contenido de archivos al \xc3\xadndice\n   mv        Mover o cambiar el nombre a archivos, directorios o enlaces simb\xc3\xb3licos\n   restore   Restaurar archivos del \xc3\xa1rbol de trabajo\n   rm        Borrar archivos del \xc3\xa1rbol de trabajo y del \xc3\xadndice\n\nexaminar el historial y el estado (mira tambi\xc3\xa9n: git help revisions)\n   bisect    Usar la b\xc3\xbasqueda binaria para encontrar el commit que introdujo el bug\n   diff      Mostrar los cambios entre commits, commit y \xc3\xa1rbol de trabajo, etc\n   grep      Imprimir las l\xc3\xadneas que concuerden con el patr\xc3\xb3n\n   log       Mostrar los logs de los commits\n   show      Mostrar varios tipos de objetos\n   status    Mostrar el estado del \xc3\xa1rbol de trabajo\n\ncrecer, marcar y ajustar tu historial com\xc3\xban\n   branch    Listar, crear, o borrar ramas\n   commit    Grabar los cambios al repositorio\n   merge     Juntar dos o m\xc3\xa1s historiales de desarrollo juntos\n   rebase    Volver a aplicar commits en la punta de otra rama\n   reset     Reiniciar el HEAD actual a un estado espec\xc3\xadfico\n   switch    Cambiar de branch\n   tag       Crear, listar, borrar o verificar un objeto de tag firmado con GPG\n\ncolaborar (mira tambi\xc3\xa9n: git help workflows)\n   fetch     Descargar objetos y referencias de otro repositorio\n   pull      Realizar un fetch e integra con otro repositorio o rama local\n   push      Actualizar referencias remotas junto con sus objetos asociados\n\n'git help -a' y 'git help -g' listan los subcomandos disponibles y algunas\ngu\xc3\xadas de concepto. Consulta 'git help <command>' o 'git help <concepto>'\npara leer sobre un subcomando o concepto espec\xc3\xadfico.\nMira 'git help git' para una vista general del sistema.\n""
[0m13:13:56.518592 [debug] [MainThread]: STDERR: "b''"
[0m13:13:56.519569 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:56.520761 [info ] [MainThread]: Connection:
[0m13:13:56.521670 [info ] [MainThread]:   host: localhost
[0m13:13:56.522463 [info ] [MainThread]:   port: 5432
[0m13:13:56.523226 [info ] [MainThread]:   user: postgres
[0m13:13:56.523986 [info ] [MainThread]:   database: data-challenge-dbt
[0m13:13:56.524752 [info ] [MainThread]:   schema: public
[0m13:13:56.525617 [info ] [MainThread]:   connect_timeout: 10
[0m13:13:56.526391 [info ] [MainThread]:   role: None
[0m13:13:56.527160 [info ] [MainThread]:   search_path: None
[0m13:13:56.527923 [info ] [MainThread]:   keepalives_idle: 0
[0m13:13:56.528842 [info ] [MainThread]:   sslmode: None
[0m13:13:56.529753 [info ] [MainThread]:   sslcert: None
[0m13:13:56.530822 [info ] [MainThread]:   sslkey: None
[0m13:13:56.531956 [info ] [MainThread]:   sslrootcert: None
[0m13:13:56.532882 [info ] [MainThread]:   application_name: dbt
[0m13:13:56.534008 [info ] [MainThread]:   retries: 1
[0m13:13:56.536288 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:13:56.537931 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:13:56.539232 [debug] [MainThread]: Using postgres connection "debug"
[0m13:13:56.540044 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:56.540757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:56.556003 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:13:56.557741 [debug] [MainThread]: On debug: Close
[0m13:13:56.558599 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:56.559585 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:13:56.560464 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/agustin/Documentos/data-challenge-dbt/dbt_project.yml> not found

[0m13:13:56.562188 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.30807158, "process_user_time": 3.67976, "process_kernel_time": 0.155651, "process_mem_max_rss": "96648", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m13:13:56.563365 [debug] [MainThread]: Command `dbt debug` failed at 13:13:56.563078 after 0.31 seconds
[0m13:13:56.564110 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:56.564916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4451d97c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444ff66c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444ff65270>]}
[0m13:13:56.566146 [debug] [MainThread]: Flushing usage events
[0m13:14:22.115336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c82b95510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c80e8dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c80e8dc00>]}


============================== 13:14:22.119825 | e22dd275-8cc6-4050-a425-6c4a6f07b085 ==============================
[0m13:14:22.119825 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:14:22.120972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/agustin/.dbt', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:14:22.121891 [info ] [MainThread]: dbt version: 1.7.4
[0m13:14:22.122653 [info ] [MainThread]: python version: 3.10.12
[0m13:14:22.123389 [info ] [MainThread]: python path: /home/agustin/.cache/pypoetry/virtualenvs/data-challenge-dbt-qpYzOUl9-py3.10/bin/python
[0m13:14:22.124122 [info ] [MainThread]: os info: Linux-6.5.0-14-generic-x86_64-with-glibc2.35
[0m13:14:22.278800 [info ] [MainThread]: Using profiles dir at /home/agustin/.dbt
[0m13:14:22.279722 [info ] [MainThread]: Using profiles.yml file at /home/agustin/.dbt/profiles.yml
[0m13:14:22.280488 [info ] [MainThread]: Using dbt_project.yml file at /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m13:14:22.281520 [info ] [MainThread]: adapter type: postgres
[0m13:14:22.282326 [info ] [MainThread]: adapter version: 1.7.4
[0m13:14:22.431615 [info ] [MainThread]: Configuration:
[0m13:14:22.432580 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:14:22.434997 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:14:22.436110 [info ] [MainThread]: Required dependencies:
[0m13:14:22.436954 [debug] [MainThread]: Executing "git --help"
[0m13:14:22.440840 [debug] [MainThread]: STDOUT: "b"uso: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nEstos son comandos comunes de Git usados en varias situaciones:\n\ncomenzar un \xc3\xa1rea de trabajo (mira tambi\xc3\xa9n: git help tutorial)\n   clone     Clonar un repositorio dentro de un nuevo directorio\n   init      Crear un repositorio de Git vac\xc3\xado o reinicia el que ya existe\n\ntrabajar en los cambios actuales (mira tambi\xc3\xa9n: git help everyday)\n   add       Agregar contenido de archivos al \xc3\xadndice\n   mv        Mover o cambiar el nombre a archivos, directorios o enlaces simb\xc3\xb3licos\n   restore   Restaurar archivos del \xc3\xa1rbol de trabajo\n   rm        Borrar archivos del \xc3\xa1rbol de trabajo y del \xc3\xadndice\n\nexaminar el historial y el estado (mira tambi\xc3\xa9n: git help revisions)\n   bisect    Usar la b\xc3\xbasqueda binaria para encontrar el commit que introdujo el bug\n   diff      Mostrar los cambios entre commits, commit y \xc3\xa1rbol de trabajo, etc\n   grep      Imprimir las l\xc3\xadneas que concuerden con el patr\xc3\xb3n\n   log       Mostrar los logs de los commits\n   show      Mostrar varios tipos de objetos\n   status    Mostrar el estado del \xc3\xa1rbol de trabajo\n\ncrecer, marcar y ajustar tu historial com\xc3\xban\n   branch    Listar, crear, o borrar ramas\n   commit    Grabar los cambios al repositorio\n   merge     Juntar dos o m\xc3\xa1s historiales de desarrollo juntos\n   rebase    Volver a aplicar commits en la punta de otra rama\n   reset     Reiniciar el HEAD actual a un estado espec\xc3\xadfico\n   switch    Cambiar de branch\n   tag       Crear, listar, borrar o verificar un objeto de tag firmado con GPG\n\ncolaborar (mira tambi\xc3\xa9n: git help workflows)\n   fetch     Descargar objetos y referencias de otro repositorio\n   pull      Realizar un fetch e integra con otro repositorio o rama local\n   push      Actualizar referencias remotas junto con sus objetos asociados\n\n'git help -a' y 'git help -g' listan los subcomandos disponibles y algunas\ngu\xc3\xadas de concepto. Consulta 'git help <command>' o 'git help <concepto>'\npara leer sobre un subcomando o concepto espec\xc3\xadfico.\nMira 'git help git' para una vista general del sistema.\n""
[0m13:14:22.441837 [debug] [MainThread]: STDERR: "b''"
[0m13:14:22.442666 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:14:22.443749 [info ] [MainThread]: Connection:
[0m13:14:22.444808 [info ] [MainThread]:   host: localhost
[0m13:14:22.445561 [info ] [MainThread]:   port: 5432
[0m13:14:22.446297 [info ] [MainThread]:   user: postgres
[0m13:14:22.446998 [info ] [MainThread]:   database: data-challenge-dbt
[0m13:14:22.447742 [info ] [MainThread]:   schema: public
[0m13:14:22.448489 [info ] [MainThread]:   connect_timeout: 10
[0m13:14:22.449208 [info ] [MainThread]:   role: None
[0m13:14:22.449941 [info ] [MainThread]:   search_path: None
[0m13:14:22.450659 [info ] [MainThread]:   keepalives_idle: 0
[0m13:14:22.451374 [info ] [MainThread]:   sslmode: None
[0m13:14:22.452080 [info ] [MainThread]:   sslcert: None
[0m13:14:22.452791 [info ] [MainThread]:   sslkey: None
[0m13:14:22.453500 [info ] [MainThread]:   sslrootcert: None
[0m13:14:22.454245 [info ] [MainThread]:   application_name: dbt
[0m13:14:22.454959 [info ] [MainThread]:   retries: 1
[0m13:14:22.455848 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:14:22.457897 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:14:22.458803 [debug] [MainThread]: Using postgres connection "debug"
[0m13:14:22.459577 [debug] [MainThread]: On debug: select 1 as id
[0m13:14:22.460519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:22.476592 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:14:22.478337 [debug] [MainThread]: On debug: Close
[0m13:14:22.479326 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:14:22.480254 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:14:22.481977 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.447223, "process_user_time": 3.783082, "process_kernel_time": 0.16396, "process_mem_max_rss": "97840", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m13:14:22.483312 [debug] [MainThread]: Command `dbt debug` succeeded at 13:14:22.483016 after 0.45 seconds
[0m13:14:22.484029 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:14:22.484800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c82b95510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c80dfd1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c80dfe680>]}
[0m13:14:22.485698 [debug] [MainThread]: Flushing usage events
[0m13:14:32.766711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491b79ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919a8dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919a8dc60>]}


============================== 13:14:32.771173 | 5ab0c4a3-5748-4894-b11e-4b916b4f25cc ==============================
[0m13:14:32.771173 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:14:32.772346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/agustin/.dbt', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:33.076070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ab0c4a3-5748-4894-b11e-4b916b4f25cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919a8dcf0>]}
[0m13:14:33.246227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ab0c4a3-5748-4894-b11e-4b916b4f25cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919a06770>]}
[0m13:14:33.247548 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:14:33.260638 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:14:33.273024 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:14:33.274241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ab0c4a3-5748-4894-b11e-4b916b4f25cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49193f7fd0>]}
[0m13:14:34.580311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ab0c4a3-5748-4894-b11e-4b916b4f25cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4918713eb0>]}
[0m13:14:34.593828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ab0c4a3-5748-4894-b11e-4b916b4f25cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4918713d30>]}
[0m13:14:34.594739 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:14:34.595652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab0c4a3-5748-4894-b11e-4b916b4f25cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49193f67d0>]}
[0m13:14:34.597487 [info ] [MainThread]: 
[0m13:14:34.598323 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:14:34.599337 [debug] [MainThread]: Command end result
[0m13:14:34.611086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9244201, "process_user_time": 5.226421, "process_kernel_time": 0.212098, "process_mem_max_rss": "101456", "process_out_blocks": "2272", "process_in_blocks": "0"}
[0m13:14:34.612257 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:34.611976 after 1.93 seconds
[0m13:14:34.613047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491b79ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49193f41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49193f4f10>]}
[0m13:14:34.613871 [debug] [MainThread]: Flushing usage events
[0m13:26:27.577960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe696f135b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe694f8ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe694f8dd50>]}


============================== 13:26:27.583071 | 8e39976b-1824-4a87-afdf-17445001f5c8 ==============================
[0m13:26:27.583071 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:26:27.584174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:26:27.893609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e39976b-1824-4a87-afdf-17445001f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe695958460>]}
[0m13:26:28.065808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e39976b-1824-4a87-afdf-17445001f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe694e1abf0>]}
[0m13:26:28.067126 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:26:28.080681 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:26:28.095059 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:26:28.096467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e39976b-1824-4a87-afdf-17445001f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6947035b0>]}
[0m13:26:29.393351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_challenge_dbt.example
- models.data_challenge_dbt.challenge
[0m13:26:29.402031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e39976b-1824-4a87-afdf-17445001f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6943e5540>]}
[0m13:26:29.415065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e39976b-1824-4a87-afdf-17445001f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6943e50c0>]}
[0m13:26:29.415993 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:26:29.416774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e39976b-1824-4a87-afdf-17445001f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe694701ff0>]}
[0m13:26:29.418773 [info ] [MainThread]: 
[0m13:26:29.419792 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:26:29.421085 [debug] [MainThread]: Command end result
[0m13:26:29.432997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9358745, "process_user_time": 5.312042, "process_kernel_time": 0.156118, "process_mem_max_rss": "101432", "process_out_blocks": "2272", "process_in_blocks": "0"}
[0m13:26:29.434213 [debug] [MainThread]: Command `dbt run` succeeded at 13:26:29.433930 after 1.94 seconds
[0m13:26:29.434990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe696f135b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe694e6a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe694e1abf0>]}
[0m13:26:29.435810 [debug] [MainThread]: Flushing usage events
[0m13:34:15.924727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121b599510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1219949d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1219949d20>]}


============================== 13:34:15.929265 | b0883419-6ec4-4972-9a9c-6968e02c3842 ==============================
[0m13:34:15.929265 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:34:15.930691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/agustin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:34:16.242548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0883419-6ec4-4972-9a9c-6968e02c3842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121a254430>]}
[0m13:34:16.414808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0883419-6ec4-4972-9a9c-6968e02c3842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12197d6bf0>]}
[0m13:34:16.416140 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:34:16.429691 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:34:16.445005 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:34:16.446477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0883419-6ec4-4972-9a9c-6968e02c3842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1219601840>]}
[0m13:34:17.757804 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.data_challenge_dbt.challenge.cines_insights
- models.data_challenge_dbt.challenge.museos
- models.data_challenge_dbt.challenge.cines
- models.data_challenge_dbt.example
- models.data_challenge_dbt.challenge.bibliotecas
- models.data_challenge_dbt.challenge.size_by_categoty_province
- models.data_challenge_dbt.challenge.size_by_category
[0m13:34:17.766356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0883419-6ec4-4972-9a9c-6968e02c3842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12191b0b50>]}
[0m13:34:17.779854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0883419-6ec4-4972-9a9c-6968e02c3842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12191b0a30>]}
[0m13:34:17.780795 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:34:17.781718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0883419-6ec4-4972-9a9c-6968e02c3842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12196026e0>]}
[0m13:34:17.783590 [info ] [MainThread]: 
[0m13:34:17.784419 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:34:17.785695 [debug] [MainThread]: Command end result
[0m13:34:17.798523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9556206, "process_user_time": 5.322001, "process_kernel_time": 0.167684, "process_mem_max_rss": "101628", "process_out_blocks": "2272", "process_in_blocks": "0"}
[0m13:34:17.799746 [debug] [MainThread]: Command `dbt run` succeeded at 13:34:17.799466 after 1.96 seconds
[0m13:34:17.800543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121b599510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12198724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12197d6bf0>]}
[0m13:34:17.801359 [debug] [MainThread]: Flushing usage events
[0m13:37:24.896328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4225f535b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4223f8ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4223f8dd50>]}


============================== 13:37:24.900888 | 26945325-8ddf-4715-89e4-ce383494c0eb ==============================
[0m13:37:24.900888 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:37:24.902106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:37:25.178526 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('data_challenge_dbt' was unexpected)

Error encountered in /home/agustin/Documentos/data-challenge-dbt/dbt_project.yml
[0m13:37:25.180316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36610916, "process_user_time": 3.766727, "process_kernel_time": 0.135954, "process_mem_max_rss": "95432", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m13:37:25.181518 [debug] [MainThread]: Command `dbt run` failed at 13:37:25.181224 after 0.37 seconds
[0m13:37:25.182348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4225f535b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f422389a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42238d0bb0>]}
[0m13:37:25.183179 [debug] [MainThread]: Flushing usage events
[0m13:40:11.004271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c474fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c278dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c278dd80>]}


============================== 13:40:11.008960 | 9133fa0a-0dbd-4c22-84c3-ddf029c6c56f ==============================
[0m13:40:11.008960 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:40:11.010101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/agustin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:40:11.318434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9133fa0a-0dbd-4c22-84c3-ddf029c6c56f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c3168490>]}
[0m13:40:11.489882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9133fa0a-0dbd-4c22-84c3-ddf029c6c56f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c2616380>]}
[0m13:40:11.491255 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:40:11.505281 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:40:11.519939 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:40:11.521266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9133fa0a-0dbd-4c22-84c3-ddf029c6c56f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c1d00820>]}
[0m13:40:12.832814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.challenge.cines_insights
- models.example
- models.challenge.cines
- models.challenge.size_by_category
- models.challenge.bibliotecas
- models.challenge.museos
- models.challenge.size_by_categoty_province
[0m13:40:12.841711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9133fa0a-0dbd-4c22-84c3-ddf029c6c56f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c197f1f0>]}
[0m13:40:12.854928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9133fa0a-0dbd-4c22-84c3-ddf029c6c56f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c197f670>]}
[0m13:40:12.855901 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:40:12.856744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9133fa0a-0dbd-4c22-84c3-ddf029c6c56f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c1d02740>]}
[0m13:40:12.858662 [info ] [MainThread]: 
[0m13:40:12.859602 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:40:12.861021 [debug] [MainThread]: Command end result
[0m13:40:12.874918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9513532, "process_user_time": 5.25233, "process_kernel_time": 0.215849, "process_mem_max_rss": "101640", "process_out_blocks": "2272", "process_in_blocks": "0"}
[0m13:40:12.876071 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:12.875789 after 1.95 seconds
[0m13:40:12.876843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c474fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c266b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c2616380>]}
[0m13:40:12.877661 [debug] [MainThread]: Flushing usage events
[0m13:41:55.592831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2478fb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff245991cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff245991c90>]}


============================== 13:41:55.597193 | 3f8a21e3-7ffa-419b-ae58-de6203b6be38 ==============================
[0m13:41:55.597193 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:41:55.598330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'debug': 'False', 'profiles_dir': '/home/agustin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:55.906482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f8a21e3-7ffa-419b-ae58-de6203b6be38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff245991d20>]}
[0m13:41:56.078184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f8a21e3-7ffa-419b-ae58-de6203b6be38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24581e6e0>]}
[0m13:41:56.079508 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:41:56.094178 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:41:56.139596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:41:56.140410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:41:56.141271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.challenge.museos
- models.challenge.size_by_category
- models.challenge.size_by_categoty_province
- models.example
- models.challenge.cines_insights
- models.challenge.cines
- models.challenge.bibliotecas
[0m13:41:56.150416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f8a21e3-7ffa-419b-ae58-de6203b6be38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24494e350>]}
[0m13:41:56.164452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f8a21e3-7ffa-419b-ae58-de6203b6be38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff244918f70>]}
[0m13:41:56.165365 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:41:56.166249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f8a21e3-7ffa-419b-ae58-de6203b6be38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2449191e0>]}
[0m13:41:56.168146 [info ] [MainThread]: 
[0m13:41:56.169022 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:41:56.170530 [debug] [MainThread]: Command end result
[0m13:41:56.183686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.67172235, "process_user_time": 3.99657, "process_kernel_time": 0.179845, "process_mem_max_rss": "101128", "process_out_blocks": "1512", "process_in_blocks": "0"}
[0m13:41:56.184851 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:56.184574 after 0.67 seconds
[0m13:41:56.185722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2478fb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24581e6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2449187f0>]}
[0m13:41:56.186522 [debug] [MainThread]: Flushing usage events
[0m13:47:05.988496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce87b42830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce85b91e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce85b91de0>]}


============================== 13:47:05.992803 | 3e380596-05e8-46d1-aa8f-ddfaea30c8f5 ==============================
[0m13:47:05.992803 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:47:05.993899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:06.302762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce865684f0>]}
[0m13:47:06.477126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce85a1ffa0>]}
[0m13:47:06.478483 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:47:06.491704 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:47:06.505122 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:47:06.506491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce855817e0>]}
[0m13:47:08.504014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m13:47:08.513710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce83d700d0>]}
[0m13:47:08.535289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce85581a20>]}
[0m13:47:08.536637 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:47:08.537753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce85581ae0>]}
[0m13:47:08.541493 [info ] [MainThread]: 
[0m13:47:08.543024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:08.545682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m13:47:08.565481 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m13:47:08.566958 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m13:47:08.567702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:08.845364 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:47:08.850542 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m13:47:08.860551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m13:47:08.884187 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m13:47:08.885416 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m13:47:08.886507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:08.901630 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.902466 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m13:47:08.903242 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:47:09.151708 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:47:09.157097 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m13:47:09.159775 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m13:47:09.180894 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.182658 [debug] [MainThread]: On master: BEGIN
[0m13:47:09.184181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:09.207307 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.208278 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.209230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:09.348063 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:47:09.352898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce83d6c8b0>]}
[0m13:47:09.355087 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:09.357420 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.359180 [debug] [MainThread]: On master: BEGIN
[0m13:47:09.361833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.363032 [debug] [MainThread]: On master: COMMIT
[0m13:47:09.364116 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.365165 [debug] [MainThread]: On master: COMMIT
[0m13:47:09.366785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.367937 [debug] [MainThread]: On master: Close
[0m13:47:09.370036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:09.371426 [info ] [MainThread]: 
[0m13:47:09.386662 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m13:47:09.388287 [info ] [Thread-1 (]: 1 of 8 START sql table model public.bibliotecas ................................ [RUN]
[0m13:47:09.390454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m13:47:09.391773 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m13:47:09.408041 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m13:47:09.409715 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 13:47:09.392557 => 13:47:09.409189
[0m13:47:09.410616 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m13:47:09.478159 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m13:47:09.479722 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m13:47:09.480602 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m13:47:09.481403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:09.494586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.495541 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m13:47:09.496416 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "domicilio" as categoria,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca;
  );
  
[0m13:47:09.498213 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: FROM raw_biblioteca;
                            ^

[0m13:47:09.499744 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: ROLLBACK
[0m13:47:09.501832 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 13:47:09.411134 => 13:47:09.501186
[0m13:47:09.502690 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m13:47:09.589389 [debug] [Thread-1 (]: Database Error in model bibliotecas (data_challenge_dbt/models/challenge/bibliotecas.sql)
  syntax error at or near ";"
  LINE 26: FROM raw_biblioteca;
                              ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/bibliotecas.sql
[0m13:47:09.590423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce83dc2a40>]}
[0m13:47:09.591589 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model public.bibliotecas ....................... [[31mERROR[0m in 0.20s]
[0m13:47:09.592882 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m13:47:09.593867 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m13:47:09.595010 [info ] [Thread-1 (]: 2 of 8 START sql table model public.cines ...................................... [RUN]
[0m13:47:09.596353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m13:47:09.597208 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m13:47:09.603668 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m13:47:09.605322 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 13:47:09.597734 => 13:47:09.604755
[0m13:47:09.606213 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m13:47:09.614703 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m13:47:09.616253 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m13:47:09.617789 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m13:47:09.618834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:09.636377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.637860 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m13:47:09.639129 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine;
  );
  
[0m13:47:09.640590 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29: FROM raw_cine;
                      ^

[0m13:47:09.641459 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: ROLLBACK
[0m13:47:09.642867 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 13:47:09.606737 => 13:47:09.642381
[0m13:47:09.643681 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m13:47:09.646175 [debug] [Thread-1 (]: Database Error in model cines (data_challenge_dbt/models/challenge/cines.sql)
  syntax error at or near ";"
  LINE 29: FROM raw_cine;
                        ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines.sql
[0m13:47:09.647306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce83dc3550>]}
[0m13:47:09.648586 [error] [Thread-1 (]: 2 of 8 ERROR creating sql table model public.cines ............................. [[31mERROR[0m in 0.05s]
[0m13:47:09.650108 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m13:47:09.651151 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m13:47:09.652332 [info ] [Thread-1 (]: 3 of 8 START sql table model public.cines_insights ............................. [RUN]
[0m13:47:09.654133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m13:47:09.655011 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m13:47:09.662290 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m13:47:09.663597 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 13:47:09.655516 => 13:47:09.663117
[0m13:47:09.664421 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m13:47:09.673655 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m13:47:09.674824 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m13:47:09.675982 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m13:47:09.677750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:09.692017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.693017 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m13:47:09.693950 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantalla") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"; 


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m13:47:09.695747 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: GROUP BY "provincia"; 
                             ^

[0m13:47:09.697305 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: ROLLBACK
[0m13:47:09.699985 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 13:47:09.664942 => 13:47:09.698852
[0m13:47:09.701079 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m13:47:09.705640 [debug] [Thread-1 (]: Database Error in model cines_insights (data_challenge_dbt/models/challenge/cines_insights.sql)
  syntax error at or near ";"
  LINE 20: GROUP BY "provincia"; 
                               ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines_insights.sql
[0m13:47:09.706760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8390ad40>]}
[0m13:47:09.707955 [error] [Thread-1 (]: 3 of 8 ERROR creating sql table model public.cines_insights .................... [[31mERROR[0m in 0.05s]
[0m13:47:09.709246 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m13:47:09.710215 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m13:47:09.711382 [info ] [Thread-1 (]: 4 of 8 START sql table model public.museos ..................................... [RUN]
[0m13:47:09.712762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m13:47:09.713751 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m13:47:09.718738 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m13:47:09.720602 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 13:47:09.714276 => 13:47:09.719838
[0m13:47:09.721802 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m13:47:09.729999 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m13:47:09.731128 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m13:47:09.731967 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m13:47:09.733073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:09.747264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.748767 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m13:47:09.750875 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo;
  );
  
[0m13:47:09.752379 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: FROM raw_museo;
                       ^

[0m13:47:09.753314 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: ROLLBACK
[0m13:47:09.754855 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 13:47:09.722352 => 13:47:09.754347
[0m13:47:09.755704 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m13:47:09.758024 [debug] [Thread-1 (]: Database Error in model museos (data_challenge_dbt/models/challenge/museos.sql)
  syntax error at or near ";"
  LINE 27: FROM raw_museo;
                         ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/museos.sql
[0m13:47:09.759051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce839f2b60>]}
[0m13:47:09.760420 [error] [Thread-1 (]: 4 of 8 ERROR creating sql table model public.museos ............................ [[31mERROR[0m in 0.05s]
[0m13:47:09.761751 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m13:47:09.762690 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_first_dbt_model
[0m13:47:09.763859 [info ] [Thread-1 (]: 5 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:47:09.765454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.my_first_dbt_model)
[0m13:47:09.766439 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_first_dbt_model
[0m13:47:09.772417 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_first_dbt_model"
[0m13:47:09.773823 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (compile): 13:47:09.767074 => 13:47:09.773303
[0m13:47:09.774664 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_first_dbt_model
[0m13:47:09.783665 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_first_dbt_model"
[0m13:47:09.785070 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:47:09.785969 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: BEGIN
[0m13:47:09.786800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:09.801315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.802676 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:47:09.803566 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */

  
    

  create  table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:47:09.982791 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m13:47:10.009966 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:47:10.011533 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:47:10.014115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.047971 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m13:47:10.048963 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:47:10.049825 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m13:47:10.060778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.072573 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup"
[0m13:47:10.081043 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:47:10.082052 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
drop table if exists "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:47:10.083535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.086987 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (execute): 13:47:09.775165 => 13:47:10.086506
[0m13:47:10.087908 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: Close
[0m13:47:10.090067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce839d05e0>]}
[0m13:47:10.092513 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.32s]
[0m13:47:10.093956 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_first_dbt_model
[0m13:47:10.095006 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m13:47:10.096318 [info ] [Thread-1 (]: 6 of 8 START sql table model public.size_by_category ........................... [RUN]
[0m13:47:10.097723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.my_first_dbt_model, now model.data_challenge_dbt.size_by_category)
[0m13:47:10.098580 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m13:47:10.103513 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m13:47:10.104871 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 13:47:10.099092 => 13:47:10.104345
[0m13:47:10.105962 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m13:47:10.114200 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m13:47:10.115538 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m13:47:10.117057 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m13:47:10.117927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:10.132189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.134028 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m13:47:10.134926 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

with categorias as(
    SELECT categoria
    FROM cines
    UNION
    SELECT categoria
    FROM museos
    SELECT categoria
    FROM bibliotecas
)

SELECT
categoria,
COUNT(categoria) AS cantidad
FROM categorias
GROUP BY categoria;
  );
  
[0m13:47:10.136698 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT categoria
             ^

[0m13:47:10.138252 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: ROLLBACK
[0m13:47:10.140082 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 13:47:10.106582 => 13:47:10.139582
[0m13:47:10.140909 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m13:47:10.145547 [debug] [Thread-1 (]: Database Error in model size_by_category (data_challenge_dbt/models/challenge/size_by_category.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT categoria
               ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/size_by_category.sql
[0m13:47:10.146660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8391f3d0>]}
[0m13:47:10.147839 [error] [Thread-1 (]: 6 of 8 ERROR creating sql table model public.size_by_category .................. [[31mERROR[0m in 0.05s]
[0m13:47:10.149134 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m13:47:10.150113 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m13:47:10.151459 [info ] [Thread-1 (]: 7 of 8 SKIP relation public.size_by_category_province .......................... [[33mSKIP[0m]
[0m13:47:10.153691 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m13:47:10.155520 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_second_dbt_model
[0m13:47:10.157102 [info ] [Thread-1 (]: 8 of 8 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:47:10.158933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category, now model.data_challenge_dbt.my_second_dbt_model)
[0m13:47:10.159809 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_second_dbt_model
[0m13:47:10.165038 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_second_dbt_model"
[0m13:47:10.166718 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (compile): 13:47:10.160325 => 13:47:10.165886
[0m13:47:10.167958 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_second_dbt_model
[0m13:47:10.204695 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_second_dbt_model"
[0m13:47:10.205939 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:47:10.206816 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: BEGIN
[0m13:47:10.207581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:10.221291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.222274 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:47:10.223096 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */

  create view "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "data-challenge-dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:47:10.287548 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:10.301317 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:47:10.303552 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:47:10.306916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.314489 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m13:47:10.316075 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:47:10.317450 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m13:47:10.327651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.336420 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup"
[0m13:47:10.342008 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:47:10.342949 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
drop view if exists "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:47:10.344253 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:10.347132 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (execute): 13:47:10.168521 => 13:47:10.346683
[0m13:47:10.348013 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: Close
[0m13:47:10.349694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e380596-05e8-46d1-aa8f-ddfaea30c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce80d2d0c0>]}
[0m13:47:10.351464 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:47:10.353258 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_second_dbt_model
[0m13:47:10.355662 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:10.356471 [debug] [MainThread]: On master: BEGIN
[0m13:47:10.357183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:10.371511 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.372367 [debug] [MainThread]: On master: COMMIT
[0m13:47:10.373086 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:10.373803 [debug] [MainThread]: On master: COMMIT
[0m13:47:10.374859 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.375659 [debug] [MainThread]: On master: Close
[0m13:47:10.377541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:10.379119 [debug] [MainThread]: Connection 'model.data_challenge_dbt.my_second_dbt_model' was properly closed.
[0m13:47:10.380489 [info ] [MainThread]: 
[0m13:47:10.381439 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m13:47:10.385909 [debug] [MainThread]: Command end result
[0m13:47:10.403153 [info ] [MainThread]: 
[0m13:47:10.404053 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m13:47:10.404795 [info ] [MainThread]: 
[0m13:47:10.405717 [error] [MainThread]:   Database Error in model bibliotecas (data_challenge_dbt/models/challenge/bibliotecas.sql)
  syntax error at or near ";"
  LINE 26: FROM raw_biblioteca;
                              ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/bibliotecas.sql
[0m13:47:10.406468 [info ] [MainThread]: 
[0m13:47:10.407198 [error] [MainThread]:   Database Error in model cines (data_challenge_dbt/models/challenge/cines.sql)
  syntax error at or near ";"
  LINE 29: FROM raw_cine;
                        ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines.sql
[0m13:47:10.407943 [info ] [MainThread]: 
[0m13:47:10.408678 [error] [MainThread]:   Database Error in model cines_insights (data_challenge_dbt/models/challenge/cines_insights.sql)
  syntax error at or near ";"
  LINE 20: GROUP BY "provincia"; 
                               ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines_insights.sql
[0m13:47:10.409563 [info ] [MainThread]: 
[0m13:47:10.410521 [error] [MainThread]:   Database Error in model museos (data_challenge_dbt/models/challenge/museos.sql)
  syntax error at or near ";"
  LINE 27: FROM raw_museo;
                         ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/museos.sql
[0m13:47:10.411550 [info ] [MainThread]: 
[0m13:47:10.412876 [error] [MainThread]:   Database Error in model size_by_category (data_challenge_dbt/models/challenge/size_by_category.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT categoria
               ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/size_by_category.sql
[0m13:47:10.414051 [info ] [MainThread]: 
[0m13:47:10.415355 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=1 TOTAL=8
[0m13:47:10.417008 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.510005, "process_user_time": 6.698124, "process_kernel_time": 0.235512, "process_mem_max_rss": "114024", "process_in_blocks": "976", "process_out_blocks": "2928", "command_success": false}
[0m13:47:10.418159 [debug] [MainThread]: Command `dbt run` failed at 13:47:10.417877 after 4.51 seconds
[0m13:47:10.418936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce87b42830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce80d5a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8454ab00>]}
[0m13:47:10.419745 [debug] [MainThread]: Flushing usage events
[0m13:50:24.148520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfc19b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfa491e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfa491db0>]}


============================== 13:50:24.153006 | ce693a19-598f-452f-8969-9afdd24e3874 ==============================
[0m13:50:24.153006 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:50:24.154181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:24.460516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfae684c0>]}
[0m13:50:24.631998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfa31f6a0>]}
[0m13:50:24.633330 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:50:24.646555 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:50:24.697612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m13:50:24.699047 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category_province.sql
[0m13:50:24.700151 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/museos.sql
[0m13:50:24.701122 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/cines.sql
[0m13:50:24.702066 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/bibliotecas.sql
[0m13:50:24.702940 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/cines_insights.sql
[0m13:50:24.703795 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category.sql
[0m13:50:25.389519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m13:50:25.399205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf8549e10>]}
[0m13:50:25.420393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf917c370>]}
[0m13:50:25.421625 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:50:25.422512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf917c5e0>]}
[0m13:50:25.425878 [info ] [MainThread]: 
[0m13:50:25.427498 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:25.430177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m13:50:25.451283 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m13:50:25.452629 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m13:50:25.453372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:25.469992 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:50:25.472191 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m13:50:25.475591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m13:50:25.486504 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m13:50:25.487364 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m13:50:25.488059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:25.501122 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:50:25.502492 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m13:50:25.503677 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:25.508935 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:50:25.511559 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m13:50:25.512708 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m13:50:25.523320 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:25.524156 [debug] [MainThread]: On master: BEGIN
[0m13:50:25.524861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:25.538279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:25.539108 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:25.539978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:25.556059 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:50:25.558918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf8546c20>]}
[0m13:50:25.559819 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:25.560967 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:25.561757 [debug] [MainThread]: On master: BEGIN
[0m13:50:25.563250 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:25.564030 [debug] [MainThread]: On master: COMMIT
[0m13:50:25.564760 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:25.565451 [debug] [MainThread]: On master: COMMIT
[0m13:50:25.566506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:50:25.567304 [debug] [MainThread]: On master: Close
[0m13:50:25.569259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:25.571012 [info ] [MainThread]: 
[0m13:50:25.575009 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m13:50:25.576042 [info ] [Thread-1 (]: 1 of 8 START sql table model public.bibliotecas ................................ [RUN]
[0m13:50:25.577395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m13:50:25.578257 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m13:50:25.592595 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m13:50:25.594035 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 13:50:25.578759 => 13:50:25.593469
[0m13:50:25.594889 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m13:50:25.667071 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m13:50:25.668368 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m13:50:25.669203 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m13:50:25.669984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:25.684381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:25.685286 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m13:50:25.686151 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "domicilio" as categoria,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca
  );
  
[0m13:50:25.836633 [debug] [Thread-1 (]: SQL status: SELECT 1902 in 0.0 seconds
[0m13:50:25.861019 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m13:50:25.862105 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
alter table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp" rename to "bibliotecas"
[0m13:50:25.863818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:25.896185 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m13:50:25.897134 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m13:50:25.897962 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m13:50:25.909182 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:25.920773 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."bibliotecas__dbt_backup"
[0m13:50:25.929100 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m13:50:25.930033 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
drop table if exists "data-challenge-dbt"."public"."bibliotecas__dbt_backup" cascade
[0m13:50:25.931348 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:25.934258 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 13:50:25.595405 => 13:50:25.933800
[0m13:50:25.935110 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m13:50:25.937321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf85f22c0>]}
[0m13:50:25.939905 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.bibliotecas ........................... [[32mSELECT 1902[0m in 0.36s]
[0m13:50:25.941374 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m13:50:25.942334 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m13:50:25.943394 [info ] [Thread-1 (]: 2 of 8 START sql table model public.cines ...................................... [RUN]
[0m13:50:25.944782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m13:50:25.945636 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m13:50:25.950704 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m13:50:25.952630 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 13:50:25.946152 => 13:50:25.951871
[0m13:50:25.953881 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m13:50:25.962466 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m13:50:25.963690 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m13:50:25.964596 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m13:50:25.965428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:25.980708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:25.982256 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m13:50:25.983912 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine
  );
  
[0m13:50:26.070325 [debug] [Thread-1 (]: SQL status: SELECT 316 in 0.0 seconds
[0m13:50:26.082851 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m13:50:26.084753 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
alter table "data-challenge-dbt"."public"."cines__dbt_tmp" rename to "cines"
[0m13:50:26.087761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:26.095810 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m13:50:26.098073 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m13:50:26.100233 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m13:50:26.120751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:26.127010 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines__dbt_backup"
[0m13:50:26.129179 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m13:50:26.130171 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
drop table if exists "data-challenge-dbt"."public"."cines__dbt_backup" cascade
[0m13:50:26.131668 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:26.134940 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 13:50:25.954464 => 13:50:26.134422
[0m13:50:26.135904 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m13:50:26.138426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf858e470>]}
[0m13:50:26.140891 [info ] [Thread-1 (]: 2 of 8 OK created sql table model public.cines ................................. [[32mSELECT 316[0m in 0.19s]
[0m13:50:26.142337 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m13:50:26.143261 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m13:50:26.144322 [info ] [Thread-1 (]: 3 of 8 START sql table model public.cines_insights ............................. [RUN]
[0m13:50:26.145807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m13:50:26.146648 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m13:50:26.151646 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m13:50:26.153116 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 13:50:26.147148 => 13:50:26.152553
[0m13:50:26.154163 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m13:50:26.164273 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m13:50:26.165779 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m13:50:26.167007 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m13:50:26.168061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:26.182120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:26.184063 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m13:50:26.185895 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantalla") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m13:50:26.187674 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "pantalla" does not exist
LINE 16: SUM("pantalla") AS pantallas,
             ^
HINT:  Perhaps you meant to reference the column "raw_cine.pantallas".

[0m13:50:26.188606 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: ROLLBACK
[0m13:50:26.190163 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 13:50:26.154759 => 13:50:26.189671
[0m13:50:26.191028 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m13:50:26.196673 [debug] [Thread-1 (]: Database Error in model cines_insights (data_challenge_dbt/models/challenge/cines_insights.sql)
  column "pantalla" does not exist
  LINE 16: SUM("pantalla") AS pantallas,
               ^
  HINT:  Perhaps you meant to reference the column "raw_cine.pantallas".
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines_insights.sql
[0m13:50:26.197846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf818ea40>]}
[0m13:50:26.199070 [error] [Thread-1 (]: 3 of 8 ERROR creating sql table model public.cines_insights .................... [[31mERROR[0m in 0.05s]
[0m13:50:26.200453 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m13:50:26.201397 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m13:50:26.202540 [info ] [Thread-1 (]: 4 of 8 START sql table model public.museos ..................................... [RUN]
[0m13:50:26.203992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m13:50:26.204864 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m13:50:26.210072 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m13:50:26.211477 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 13:50:26.205401 => 13:50:26.210935
[0m13:50:26.212425 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m13:50:26.221275 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m13:50:26.222558 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m13:50:26.223421 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m13:50:26.224229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:26.238917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:26.240487 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m13:50:26.242431 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo
  );
  
[0m13:50:26.395680 [debug] [Thread-1 (]: SQL status: SELECT 1182 in 0.0 seconds
[0m13:50:26.408399 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m13:50:26.410298 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
alter table "data-challenge-dbt"."public"."museos__dbt_tmp" rename to "museos"
[0m13:50:26.413209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:26.420107 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m13:50:26.421409 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m13:50:26.422559 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m13:50:26.445393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:26.456754 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."museos__dbt_backup"
[0m13:50:26.461523 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m13:50:26.463161 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
drop table if exists "data-challenge-dbt"."public"."museos__dbt_backup" cascade
[0m13:50:26.465087 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:26.470278 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 13:50:26.212981 => 13:50:26.469323
[0m13:50:26.471761 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m13:50:26.474172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf8580370>]}
[0m13:50:26.475908 [info ] [Thread-1 (]: 4 of 8 OK created sql table model public.museos ................................ [[32mSELECT 1182[0m in 0.27s]
[0m13:50:26.477381 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m13:50:26.478353 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_first_dbt_model
[0m13:50:26.479510 [info ] [Thread-1 (]: 5 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:50:26.481165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.my_first_dbt_model)
[0m13:50:26.482106 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_first_dbt_model
[0m13:50:26.487277 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.488966 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (compile): 13:50:26.482622 => 13:50:26.488268
[0m13:50:26.490090 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_first_dbt_model
[0m13:50:26.499436 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.501053 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.502081 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: BEGIN
[0m13:50:26.502973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:26.519135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:26.520036 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.520885 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */

  
    

  create  table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:50:26.523707 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m13:50:26.531769 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.532672 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:50:26.534162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:26.540193 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.541135 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:50:26.542560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:26.550498 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m13:50:26.551418 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.552239 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m13:50:26.578792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:26.584230 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup"
[0m13:50:26.586163 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m13:50:26.587060 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
drop table if exists "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:50:26.702492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:26.709347 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (execute): 13:50:26.490617 => 13:50:26.708243
[0m13:50:26.711501 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: Close
[0m13:50:26.716801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf8581f30>]}
[0m13:50:26.723047 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.24s]
[0m13:50:26.726528 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_first_dbt_model
[0m13:50:26.728794 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m13:50:26.731333 [info ] [Thread-1 (]: 6 of 8 START sql table model public.size_by_category ........................... [RUN]
[0m13:50:26.733654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.my_first_dbt_model, now model.data_challenge_dbt.size_by_category)
[0m13:50:26.735095 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m13:50:26.743848 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m13:50:26.746101 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 13:50:26.735958 => 13:50:26.745189
[0m13:50:26.747539 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m13:50:26.760624 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m13:50:26.761888 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m13:50:26.762789 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m13:50:26.763645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:26.777458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:26.778510 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m13:50:26.779353 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

with categorias as(
    SELECT categoria
    FROM cines
    UNION
    SELECT categoria
    FROM museos
    SELECT categoria
    FROM bibliotecas
)

SELECT
categoria,
COUNT(categoria) AS cantidad
FROM categorias
GROUP BY categoria
  );
  
[0m13:50:26.780742 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT categoria
             ^

[0m13:50:26.781769 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: ROLLBACK
[0m13:50:26.783351 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 13:50:26.748411 => 13:50:26.782835
[0m13:50:26.784223 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m13:50:26.786677 [debug] [Thread-1 (]: Database Error in model size_by_category (data_challenge_dbt/models/challenge/size_by_category.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT categoria
               ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/size_by_category.sql
[0m13:50:26.787839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf571e050>]}
[0m13:50:26.789117 [error] [Thread-1 (]: 6 of 8 ERROR creating sql table model public.size_by_category .................. [[31mERROR[0m in 0.06s]
[0m13:50:26.790482 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m13:50:26.791417 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m13:50:26.792598 [info ] [Thread-1 (]: 7 of 8 START sql table model public.size_by_category_province .................. [RUN]
[0m13:50:26.794224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category, now model.data_challenge_dbt.size_by_category_province)
[0m13:50:26.795261 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category_province
[0m13:50:26.801693 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category_province"
[0m13:50:26.803203 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (compile): 13:50:26.795820 => 13:50:26.802618
[0m13:50:26.804100 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category_province
[0m13:50:26.813141 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category_province"
[0m13:50:26.814353 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m13:50:26.815291 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: BEGIN
[0m13:50:26.816401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:26.832131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:26.833024 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m13:50:26.833963 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp"
  
  
    as
  
  (
    

with categorias as(
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."cines"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."museos"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."bibliotecas"
)

SELECT
categoria,
provincia,
COUNT(categoria) AS cantidad
FROM categorias
GROUP BY categoria, provincia
  );
  
[0m13:50:27.055576 [debug] [Thread-1 (]: SQL status: SELECT 1940 in 0.0 seconds
[0m13:50:27.071120 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m13:50:27.072286 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
alter table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp" rename to "size_by_category_province"
[0m13:50:27.074677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:27.078856 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m13:50:27.079749 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m13:50:27.080560 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m13:50:27.136917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:27.149690 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category_province__dbt_backup"
[0m13:50:27.154560 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m13:50:27.156888 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category_province__dbt_backup" cascade
[0m13:50:27.160152 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:27.164806 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (execute): 13:50:26.804617 => 13:50:27.164065
[0m13:50:27.165968 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: Close
[0m13:50:27.168600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf5731240>]}
[0m13:50:27.171500 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.size_by_category_province ............. [[32mSELECT 1940[0m in 0.37s]
[0m13:50:27.172978 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m13:50:27.174006 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_second_dbt_model
[0m13:50:27.175169 [info ] [Thread-1 (]: 8 of 8 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:50:27.176589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category_province, now model.data_challenge_dbt.my_second_dbt_model)
[0m13:50:27.177452 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_second_dbt_model
[0m13:50:27.182620 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_second_dbt_model"
[0m13:50:27.184505 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (compile): 13:50:27.177997 => 13:50:27.183752
[0m13:50:27.185837 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_second_dbt_model
[0m13:50:27.224848 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_second_dbt_model"
[0m13:50:27.226113 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:50:27.227127 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: BEGIN
[0m13:50:27.227951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:27.241749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:50:27.242735 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:50:27.243700 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */

  create view "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "data-challenge-dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:50:27.246711 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:50:27.252628 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:50:27.253578 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:50:27.255152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:27.258485 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m13:50:27.259396 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:50:27.260181 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m13:50:27.280534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:50:27.285975 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup"
[0m13:50:27.291449 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m13:50:27.292339 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
drop view if exists "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:50:27.293654 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:50:27.296412 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (execute): 13:50:27.186502 => 13:50:27.295965
[0m13:50:27.297246 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: Close
[0m13:50:27.298977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce693a19-598f-452f-8969-9afdd24e3874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf57460b0>]}
[0m13:50:27.300260 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:50:27.301769 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_second_dbt_model
[0m13:50:27.304227 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:27.305056 [debug] [MainThread]: On master: BEGIN
[0m13:50:27.305784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:27.320440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:27.321372 [debug] [MainThread]: On master: COMMIT
[0m13:50:27.322139 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:27.323040 [debug] [MainThread]: On master: COMMIT
[0m13:50:27.324587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:50:27.325446 [debug] [MainThread]: On master: Close
[0m13:50:27.326835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:27.327642 [debug] [MainThread]: Connection 'model.data_challenge_dbt.my_second_dbt_model' was properly closed.
[0m13:50:27.328492 [info ] [MainThread]: 
[0m13:50:27.329637 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m13:50:27.332903 [debug] [MainThread]: Command end result
[0m13:50:27.351351 [info ] [MainThread]: 
[0m13:50:27.352325 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:50:27.353186 [info ] [MainThread]: 
[0m13:50:27.354023 [error] [MainThread]:   Database Error in model cines_insights (data_challenge_dbt/models/challenge/cines_insights.sql)
  column "pantalla" does not exist
  LINE 16: SUM("pantalla") AS pantallas,
               ^
  HINT:  Perhaps you meant to reference the column "raw_cine.pantallas".
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines_insights.sql
[0m13:50:27.354838 [info ] [MainThread]: 
[0m13:50:27.355617 [error] [MainThread]:   Database Error in model size_by_category (data_challenge_dbt/models/challenge/size_by_category.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT categoria
               ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/size_by_category.sql
[0m13:50:27.356414 [info ] [MainThread]: 
[0m13:50:27.357220 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m13:50:27.358840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2909887, "process_user_time": 5.714521, "process_kernel_time": 0.223942, "process_mem_max_rss": "114000", "process_out_blocks": "2960", "command_success": false, "process_in_blocks": "0"}
[0m13:50:27.360019 [debug] [MainThread]: Command `dbt run` failed at 13:50:27.359737 after 3.29 seconds
[0m13:50:27.361106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfc19b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf9d0e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf571f4f0>]}
[0m13:50:27.362305 [debug] [MainThread]: Flushing usage events
[0m13:59:59.453364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa687b9f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa685e91e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa685e91db0>]}


============================== 13:59:59.458029 | bd4ff72d-91c2-4564-96ae-505487d48987 ==============================
[0m13:59:59.458029 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:59:59.459649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:59:59.772134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6868684c0>]}
[0m13:59:59.944359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa685d1f6a0>]}
[0m13:59:59.945725 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:59:59.958994 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:00:00.014256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:00:00.015549 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category.sql
[0m14:00:00.016460 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/cines_insights.sql
[0m14:00:00.017510 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/bibliotecas.sql
[0m14:00:00.624374 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m14:00:00.634998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683f11f90>]}
[0m14:00:00.656824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa684b5fd00>]}
[0m14:00:00.657832 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:00:00.658661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa684b5ffd0>]}
[0m14:00:00.662167 [info ] [MainThread]: 
[0m14:00:00.664434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:00.667765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m14:00:00.686746 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m14:00:00.687746 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:00:00.688489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:00.704506 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:00:00.706738 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m14:00:00.711270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m14:00:00.721962 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m14:00:00.722826 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m14:00:00.723547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:00.736639 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.737998 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m14:00:00.739482 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:00:00.745009 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:00:00.747390 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m14:00:00.748701 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m14:00:00.759641 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.760463 [debug] [MainThread]: On master: BEGIN
[0m14:00:00.761155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:00.774347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.775234 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.776127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:00.791266 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:00:00.795003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa684385870>]}
[0m14:00:00.795971 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:00.797198 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.798034 [debug] [MainThread]: On master: BEGIN
[0m14:00:00.799656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.800957 [debug] [MainThread]: On master: COMMIT
[0m14:00:00.802002 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.802704 [debug] [MainThread]: On master: COMMIT
[0m14:00:00.803735 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:00.804526 [debug] [MainThread]: On master: Close
[0m14:00:00.806000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:00.807002 [info ] [MainThread]: 
[0m14:00:00.810933 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m14:00:00.811985 [info ] [Thread-1 (]: 1 of 8 START sql table model public.bibliotecas ................................ [RUN]
[0m14:00:00.813354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m14:00:00.814247 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m14:00:00.827581 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m14:00:00.829342 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 14:00:00.814758 => 14:00:00.828449
[0m14:00:00.830694 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m14:00:00.899164 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m14:00:00.900537 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:00:00.901397 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m14:00:00.902222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:00.915320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.916885 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:00:00.918110 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "domicilio" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca
  );
  
[0m14:00:01.002897 [debug] [Thread-1 (]: SQL status: SELECT 1902 in 0.0 seconds
[0m14:00:01.022932 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:00:01.024489 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
alter table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp" rename to "bibliotecas"
[0m14:00:01.026325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.059305 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m14:00:01.060273 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:00:01.061104 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m14:00:01.091965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.106357 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."bibliotecas__dbt_backup"
[0m14:00:01.115341 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:00:01.116258 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
drop table if exists "data-challenge-dbt"."public"."bibliotecas__dbt_backup" cascade
[0m14:00:01.117674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:01.120502 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 14:00:00.831241 => 14:00:01.120055
[0m14:00:01.121394 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m14:00:01.122982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683f91ae0>]}
[0m14:00:01.124291 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.bibliotecas ........................... [[32mSELECT 1902[0m in 0.31s]
[0m14:00:01.125818 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m14:00:01.126885 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m14:00:01.127959 [info ] [Thread-1 (]: 2 of 8 START sql table model public.cines ...................................... [RUN]
[0m14:00:01.129462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m14:00:01.130376 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m14:00:01.137864 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m14:00:01.139295 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 14:00:01.130899 => 14:00:01.138795
[0m14:00:01.140144 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m14:00:01.148698 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m14:00:01.149974 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:00:01.150931 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m14:00:01.152102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:01.168311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:01.169840 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:00:01.171462 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine
  );
  
[0m14:00:01.252726 [debug] [Thread-1 (]: SQL status: SELECT 316 in 0.0 seconds
[0m14:00:01.266121 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:00:01.268154 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
alter table "data-challenge-dbt"."public"."cines__dbt_tmp" rename to "cines"
[0m14:00:01.271246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.279440 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m14:00:01.281293 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:00:01.283060 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m14:00:01.293021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.307158 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines__dbt_backup"
[0m14:00:01.311160 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:00:01.312994 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
drop table if exists "data-challenge-dbt"."public"."cines__dbt_backup" cascade
[0m14:00:01.315257 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:01.319348 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 14:00:01.140655 => 14:00:01.318743
[0m14:00:01.320333 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m14:00:01.322167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683b11de0>]}
[0m14:00:01.323678 [info ] [Thread-1 (]: 2 of 8 OK created sql table model public.cines ................................. [[32mSELECT 316[0m in 0.19s]
[0m14:00:01.325432 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m14:00:01.326567 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m14:00:01.327750 [info ] [Thread-1 (]: 3 of 8 START sql table model public.cines_insights ............................. [RUN]
[0m14:00:01.329255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m14:00:01.330244 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m14:00:01.335397 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m14:00:01.336899 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 14:00:01.330771 => 14:00:01.336368
[0m14:00:01.337797 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m14:00:01.346880 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m14:00:01.348437 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:00:01.349299 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m14:00:01.350139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:01.365890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:01.367341 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:00:01.368248 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantallas") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m14:00:01.418756 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m14:00:01.431868 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:00:01.433851 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
alter table "data-challenge-dbt"."public"."cines_insights__dbt_tmp" rename to "cines_insights"
[0m14:00:01.436928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.444605 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m14:00:01.445963 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:00:01.447161 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m14:00:01.470981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.484605 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines_insights__dbt_backup"
[0m14:00:01.488268 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:00:01.489726 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
drop table if exists "data-challenge-dbt"."public"."cines_insights__dbt_backup" cascade
[0m14:00:01.491495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:01.495674 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 14:00:01.338307 => 14:00:01.494856
[0m14:00:01.497424 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m14:00:01.499726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683b8e470>]}
[0m14:00:01.501461 [info ] [Thread-1 (]: 3 of 8 OK created sql table model public.cines_insights ........................ [[32mSELECT 24[0m in 0.17s]
[0m14:00:01.503607 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m14:00:01.504938 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m14:00:01.506424 [info ] [Thread-1 (]: 4 of 8 START sql table model public.museos ..................................... [RUN]
[0m14:00:01.508305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m14:00:01.509494 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m14:00:01.516731 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m14:00:01.518680 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 14:00:01.510248 => 14:00:01.517943
[0m14:00:01.519879 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m14:00:01.530004 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m14:00:01.532567 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:00:01.533716 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m14:00:01.534662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:01.549021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:01.549996 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:00:01.550981 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo
  );
  
[0m14:00:01.614111 [debug] [Thread-1 (]: SQL status: SELECT 1182 in 0.0 seconds
[0m14:00:01.626281 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:00:01.628142 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
alter table "data-challenge-dbt"."public"."museos__dbt_tmp" rename to "museos"
[0m14:00:01.630958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.637525 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m14:00:01.638945 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:00:01.639939 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m14:00:01.661791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.667038 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."museos__dbt_backup"
[0m14:00:01.668904 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:00:01.669767 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
drop table if exists "data-challenge-dbt"."public"."museos__dbt_backup" cascade
[0m14:00:01.671041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:01.673953 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 14:00:01.520589 => 14:00:01.673416
[0m14:00:01.674847 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m14:00:01.676479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683b83070>]}
[0m14:00:01.677873 [info ] [Thread-1 (]: 4 of 8 OK created sql table model public.museos ................................ [[32mSELECT 1182[0m in 0.17s]
[0m14:00:01.679979 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m14:00:01.681009 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_first_dbt_model
[0m14:00:01.682381 [info ] [Thread-1 (]: 5 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:00:01.683913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.my_first_dbt_model)
[0m14:00:01.684797 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_first_dbt_model
[0m14:00:01.689878 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.691323 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (compile): 14:00:01.685320 => 14:00:01.690780
[0m14:00:01.692199 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_first_dbt_model
[0m14:00:01.701282 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.702561 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.703439 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: BEGIN
[0m14:00:01.704241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:01.718908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:01.720464 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.721895 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */

  
    

  create  table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:00:01.724743 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:00:01.732840 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.733861 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:00:01.735370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.741150 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.742138 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:00:01.743768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.751682 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m14:00:01.752632 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.753506 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m14:00:01.773145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.781400 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup"
[0m14:00:01.784352 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:00:01.785392 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
drop table if exists "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:00:01.795360 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:01.798178 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (execute): 14:00:01.692711 => 14:00:01.797733
[0m14:00:01.799014 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: Close
[0m14:00:01.800600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa684b7c490>]}
[0m14:00:01.801986 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m14:00:01.803650 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_first_dbt_model
[0m14:00:01.804596 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m14:00:01.805927 [info ] [Thread-1 (]: 6 of 8 START sql table model public.size_by_category ........................... [RUN]
[0m14:00:01.807332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.my_first_dbt_model, now model.data_challenge_dbt.size_by_category)
[0m14:00:01.808167 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m14:00:01.812953 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m14:00:01.814673 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 14:00:01.808672 => 14:00:01.814125
[0m14:00:01.815669 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m14:00:01.823931 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m14:00:01.825144 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:00:01.825985 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m14:00:01.826743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:01.841432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:01.842382 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:00:01.843225 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

with categorias as(
    SELECT categoria FROM cines
    UNION
    SELECT categoria FROM museos
    UNION
    SELECT categoria FROM bibliotecas
)

SELECT
categoria,
COUNT(categoria) AS cantidad
FROM categorias
GROUP BY categoria
  );
  
[0m14:00:01.901342 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:00:01.914553 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:00:01.916558 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
alter table "data-challenge-dbt"."public"."size_by_category__dbt_tmp" rename to "size_by_category"
[0m14:00:01.919432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.926425 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m14:00:01.927766 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:00:01.929001 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m14:00:01.950973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.957009 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category__dbt_backup"
[0m14:00:01.959278 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:00:01.960283 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category__dbt_backup" cascade
[0m14:00:01.961895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:01.965103 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 14:00:01.816275 => 14:00:01.964584
[0m14:00:01.966103 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m14:00:01.968016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683bb0e80>]}
[0m14:00:01.969983 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.size_by_category ...................... [[32mSELECT 3[0m in 0.16s]
[0m14:00:01.971822 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m14:00:01.972798 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m14:00:01.973933 [info ] [Thread-1 (]: 7 of 8 START sql table model public.size_by_category_province .................. [RUN]
[0m14:00:01.975388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category, now model.data_challenge_dbt.size_by_category_province)
[0m14:00:01.976261 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category_province
[0m14:00:01.982696 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category_province"
[0m14:00:01.984384 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (compile): 14:00:01.976768 => 14:00:01.983790
[0m14:00:01.985452 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category_province
[0m14:00:01.996212 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category_province"
[0m14:00:01.998826 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:00:02.000009 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: BEGIN
[0m14:00:02.000971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:02.016839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:02.017842 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:00:02.018756 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp"
  
  
    as
  
  (
    

with categorias as(
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."cines"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."museos"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."bibliotecas"
)

SELECT
categoria,
provincia,
COUNT(categoria) AS cantidad
FROM categorias
GROUP BY categoria, provincia
  );
  
[0m14:00:02.067175 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.0 seconds
[0m14:00:02.079213 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:00:02.081209 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
alter table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp" rename to "size_by_category_province"
[0m14:00:02.084191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:02.092133 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m14:00:02.094078 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:00:02.095865 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m14:00:02.118492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:02.129540 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category_province__dbt_backup"
[0m14:00:02.133672 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:00:02.135562 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category_province__dbt_backup" cascade
[0m14:00:02.138285 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:02.144225 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (execute): 14:00:01.986286 => 14:00:02.143254
[0m14:00:02.146154 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: Close
[0m14:00:02.149409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683f31360>]}
[0m14:00:02.152173 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.size_by_category_province ............. [[32mSELECT 72[0m in 0.17s]
[0m14:00:02.155933 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m14:00:02.158158 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_second_dbt_model
[0m14:00:02.160523 [info ] [Thread-1 (]: 8 of 8 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:00:02.163604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category_province, now model.data_challenge_dbt.my_second_dbt_model)
[0m14:00:02.165571 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_second_dbt_model
[0m14:00:02.174162 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_second_dbt_model"
[0m14:00:02.175769 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (compile): 14:00:02.166824 => 14:00:02.175168
[0m14:00:02.176759 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_second_dbt_model
[0m14:00:02.213433 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_second_dbt_model"
[0m14:00:02.214779 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:00:02.215662 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: BEGIN
[0m14:00:02.216458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:02.231442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:02.232384 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:00:02.233226 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */

  create view "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "data-challenge-dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:00:02.236186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:00:02.242034 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:00:02.242938 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:00:02.244463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:02.247686 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m14:00:02.248550 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:00:02.249324 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m14:00:02.273694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:02.278981 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup"
[0m14:00:02.284189 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:00:02.285098 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
drop view if exists "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:00:02.286421 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:00:02.289264 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (execute): 14:00:02.177348 => 14:00:02.288816
[0m14:00:02.290196 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: Close
[0m14:00:02.291854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4ff72d-91c2-4564-96ae-505487d48987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683f32410>]}
[0m14:00:02.293190 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:00:02.295150 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_second_dbt_model
[0m14:00:02.297972 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:02.298775 [debug] [MainThread]: On master: BEGIN
[0m14:00:02.299476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:02.312569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:02.314036 [debug] [MainThread]: On master: COMMIT
[0m14:00:02.315709 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:02.316934 [debug] [MainThread]: On master: COMMIT
[0m14:00:02.318411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:02.319197 [debug] [MainThread]: On master: Close
[0m14:00:02.321073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:02.322201 [debug] [MainThread]: Connection 'model.data_challenge_dbt.my_second_dbt_model' was properly closed.
[0m14:00:02.323174 [info ] [MainThread]: 
[0m14:00:02.324131 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m14:00:02.328396 [debug] [MainThread]: Command end result
[0m14:00:02.347335 [info ] [MainThread]: 
[0m14:00:02.348343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:02.349154 [info ] [MainThread]: 
[0m14:00:02.350011 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:00:02.351834 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9798052, "process_user_time": 5.647329, "process_kernel_time": 0.207681, "process_mem_max_rss": "113104", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m14:00:02.353400 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:02.353090 after 2.98 seconds
[0m14:00:02.354247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa687b9f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa685d1f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa683b2a7a0>]}
[0m14:00:02.355682 [debug] [MainThread]: Flushing usage events
[0m14:06:49.956799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9328915510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9326991d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9326991d20>]}


============================== 14:06:49.961334 | bd7c64f0-23e5-454f-855d-f989db8ffd56 ==============================
[0m14:06:49.961334 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:06:49.963543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:50.276934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932735c430>]}
[0m14:06:50.449188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932681ebf0>]}
[0m14:06:50.450518 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m14:06:50.464474 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:06:50.518226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:50.519532 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category.sql
[0m14:06:50.922113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m14:06:50.931670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93255f0160>]}
[0m14:06:50.954240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9325967cd0>]}
[0m14:06:50.955672 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:06:50.956550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9325967f10>]}
[0m14:06:50.959963 [info ] [MainThread]: 
[0m14:06:50.961483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:50.964276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m14:06:50.983903 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m14:06:50.985214 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:06:50.986108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:51.001659 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:06:51.003867 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m14:06:51.007269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m14:06:51.018480 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m14:06:51.019359 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m14:06:51.020078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:51.033280 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.034364 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m14:06:51.035156 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:51.040247 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:06:51.042556 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m14:06:51.043693 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m14:06:51.054234 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.055043 [debug] [MainThread]: On master: BEGIN
[0m14:06:51.055722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:51.068790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.069996 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.070899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:51.085743 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:51.088366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93255de590>]}
[0m14:06:51.089240 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:51.090285 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.091021 [debug] [MainThread]: On master: BEGIN
[0m14:06:51.092305 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.093122 [debug] [MainThread]: On master: COMMIT
[0m14:06:51.094129 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:51.094824 [debug] [MainThread]: On master: COMMIT
[0m14:06:51.095960 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:51.096796 [debug] [MainThread]: On master: Close
[0m14:06:51.098304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:51.099321 [info ] [MainThread]: 
[0m14:06:51.103685 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m14:06:51.104736 [info ] [Thread-1 (]: 1 of 8 START sql table model public.bibliotecas ................................ [RUN]
[0m14:06:51.106240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m14:06:51.107221 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m14:06:51.121682 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m14:06:51.123030 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 14:06:51.107735 => 14:06:51.122540
[0m14:06:51.123895 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m14:06:51.199156 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m14:06:51.200521 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:06:51.201357 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m14:06:51.202157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:51.215381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.216276 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:06:51.217104 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "domicilio" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca
  );
  
[0m14:06:51.272540 [debug] [Thread-1 (]: SQL status: SELECT 1902 in 0.0 seconds
[0m14:06:51.290689 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:06:51.291865 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
alter table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp" rename to "bibliotecas"
[0m14:06:51.293627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:51.325129 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m14:06:51.326042 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:06:51.326818 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m14:06:51.370956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:51.386317 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."bibliotecas__dbt_backup"
[0m14:06:51.395627 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:06:51.396530 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
drop table if exists "data-challenge-dbt"."public"."bibliotecas__dbt_backup" cascade
[0m14:06:51.397881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:51.400981 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 14:06:51.124399 => 14:06:51.400522
[0m14:06:51.401890 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m14:06:51.403474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93251e9600>]}
[0m14:06:51.404756 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.bibliotecas ........................... [[32mSELECT 1902[0m in 0.30s]
[0m14:06:51.406279 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m14:06:51.407289 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m14:06:51.408428 [info ] [Thread-1 (]: 2 of 8 START sql table model public.cines ...................................... [RUN]
[0m14:06:51.409832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m14:06:51.410725 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m14:06:51.415892 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m14:06:51.417462 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 14:06:51.411239 => 14:06:51.416851
[0m14:06:51.418454 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m14:06:51.426782 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m14:06:51.428008 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:06:51.428894 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m14:06:51.429779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:51.444470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.445803 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:06:51.446682 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine
  );
  
[0m14:06:51.501741 [debug] [Thread-1 (]: SQL status: SELECT 316 in 0.0 seconds
[0m14:06:51.514445 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:06:51.516391 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
alter table "data-challenge-dbt"."public"."cines__dbt_tmp" rename to "cines"
[0m14:06:51.519336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:51.527327 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m14:06:51.528949 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:06:51.530218 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m14:06:51.549315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:51.555502 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines__dbt_backup"
[0m14:06:51.557729 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:06:51.558742 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
drop table if exists "data-challenge-dbt"."public"."cines__dbt_backup" cascade
[0m14:06:51.560274 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:51.563556 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 14:06:51.418980 => 14:06:51.563045
[0m14:06:51.564569 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m14:06:51.566562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93259a6860>]}
[0m14:06:51.568055 [info ] [Thread-1 (]: 2 of 8 OK created sql table model public.cines ................................. [[32mSELECT 316[0m in 0.16s]
[0m14:06:51.569839 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m14:06:51.570787 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m14:06:51.571942 [info ] [Thread-1 (]: 3 of 8 START sql table model public.cines_insights ............................. [RUN]
[0m14:06:51.573395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m14:06:51.574439 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m14:06:51.579790 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m14:06:51.581360 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 14:06:51.575375 => 14:06:51.580740
[0m14:06:51.582271 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m14:06:51.590583 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m14:06:51.591852 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:06:51.592708 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m14:06:51.593513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:51.607568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.608528 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:06:51.609649 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantallas") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m14:06:51.655261 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m14:06:51.668674 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:06:51.670351 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
alter table "data-challenge-dbt"."public"."cines_insights__dbt_tmp" rename to "cines_insights"
[0m14:06:51.672755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:51.679324 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m14:06:51.680860 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:06:51.682327 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m14:06:51.705063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:51.711656 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines_insights__dbt_backup"
[0m14:06:51.714140 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:06:51.715285 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
drop table if exists "data-challenge-dbt"."public"."cines_insights__dbt_backup" cascade
[0m14:06:51.716941 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:51.720599 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 14:06:51.582783 => 14:06:51.720024
[0m14:06:51.721846 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m14:06:51.723806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9324d5ca30>]}
[0m14:06:51.725147 [info ] [Thread-1 (]: 3 of 8 OK created sql table model public.cines_insights ........................ [[32mSELECT 24[0m in 0.15s]
[0m14:06:51.726706 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m14:06:51.727705 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m14:06:51.728806 [info ] [Thread-1 (]: 4 of 8 START sql table model public.museos ..................................... [RUN]
[0m14:06:51.730256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m14:06:51.731102 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m14:06:51.736096 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m14:06:51.737562 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 14:06:51.731601 => 14:06:51.737004
[0m14:06:51.738671 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m14:06:51.746992 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m14:06:51.748933 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:06:51.749903 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m14:06:51.750742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:51.765214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.766969 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:06:51.768294 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo
  );
  
[0m14:06:51.829189 [debug] [Thread-1 (]: SQL status: SELECT 1182 in 0.0 seconds
[0m14:06:51.841360 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:06:51.843289 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
alter table "data-challenge-dbt"."public"."museos__dbt_tmp" rename to "museos"
[0m14:06:51.846103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:51.852255 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m14:06:51.853558 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:06:51.854487 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m14:06:51.873889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:51.879128 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."museos__dbt_backup"
[0m14:06:51.880959 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:06:51.881806 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
drop table if exists "data-challenge-dbt"."public"."museos__dbt_backup" cascade
[0m14:06:51.883065 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:51.885991 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 14:06:51.739195 => 14:06:51.885515
[0m14:06:51.886872 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m14:06:51.888614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9324d5c970>]}
[0m14:06:51.889932 [info ] [Thread-1 (]: 4 of 8 OK created sql table model public.museos ................................ [[32mSELECT 1182[0m in 0.16s]
[0m14:06:51.891364 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m14:06:51.892326 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_first_dbt_model
[0m14:06:51.893487 [info ] [Thread-1 (]: 5 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:06:51.895213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.my_first_dbt_model)
[0m14:06:51.896437 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_first_dbt_model
[0m14:06:51.901960 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.903419 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (compile): 14:06:51.897305 => 14:06:51.902869
[0m14:06:51.904274 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_first_dbt_model
[0m14:06:51.912867 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.914271 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.916033 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: BEGIN
[0m14:06:51.917173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:51.931838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:51.933061 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.934003 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */

  
    

  create  table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:06:51.936772 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:06:51.945076 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.946025 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:06:51.947436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:51.953096 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.954045 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:06:51.955408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:51.963136 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m14:06:51.964036 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.964807 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m14:06:51.985011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:51.990457 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup"
[0m14:06:51.992311 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:06:51.993133 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
drop table if exists "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:06:52.007241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:52.010155 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (execute): 14:06:51.904775 => 14:06:52.009707
[0m14:06:52.011011 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: Close
[0m14:06:52.012531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9325127af0>]}
[0m14:06:52.013832 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m14:06:52.015412 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_first_dbt_model
[0m14:06:52.016385 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m14:06:52.017558 [info ] [Thread-1 (]: 6 of 8 START sql table model public.size_by_category ........................... [RUN]
[0m14:06:52.019215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.my_first_dbt_model, now model.data_challenge_dbt.size_by_category)
[0m14:06:52.020112 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m14:06:52.025209 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m14:06:52.026907 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 14:06:52.020624 => 14:06:52.026171
[0m14:06:52.027841 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m14:06:52.037153 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m14:06:52.038395 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:06:52.039263 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m14:06:52.040055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:52.054770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:52.056267 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:06:52.057730 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

with categorias as(
    SELECT categoria FROM cines
    UNION
    SELECT categoria FROM museos
    UNION
    SELECT categoria FROM bibliotecas
)

SELECT
categoria,
COUNT(categorias) AS cantidad
FROM categorias
GROUP BY categoria
  );
  
[0m14:06:52.104674 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:06:52.118826 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:06:52.120961 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
alter table "data-challenge-dbt"."public"."size_by_category__dbt_tmp" rename to "size_by_category"
[0m14:06:52.123903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:52.131826 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m14:06:52.133573 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:06:52.134839 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m14:06:52.151927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:52.159491 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category__dbt_backup"
[0m14:06:52.162762 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:06:52.164088 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category__dbt_backup" cascade
[0m14:06:52.166018 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:52.169780 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 14:06:52.028394 => 14:06:52.169231
[0m14:06:52.170798 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m14:06:52.172651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9324d83370>]}
[0m14:06:52.174040 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.size_by_category ...................... [[32mSELECT 3[0m in 0.15s]
[0m14:06:52.175523 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m14:06:52.176484 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m14:06:52.177662 [info ] [Thread-1 (]: 7 of 8 START sql table model public.size_by_category_province .................. [RUN]
[0m14:06:52.179077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category, now model.data_challenge_dbt.size_by_category_province)
[0m14:06:52.179951 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category_province
[0m14:06:52.188043 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category_province"
[0m14:06:52.189410 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (compile): 14:06:52.180459 => 14:06:52.188890
[0m14:06:52.190278 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category_province
[0m14:06:52.198846 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category_province"
[0m14:06:52.200107 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:06:52.200976 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: BEGIN
[0m14:06:52.202128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:52.217142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:52.218700 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:06:52.220349 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp"
  
  
    as
  
  (
    

with categorias as(
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."cines"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."museos"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."bibliotecas"
)

SELECT
categoria,
provincia,
COUNT(categoria) AS cantidad
FROM categorias
GROUP BY categoria, provincia
  );
  
[0m14:06:52.285000 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.0 seconds
[0m14:06:52.298703 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:06:52.300786 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
alter table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp" rename to "size_by_category_province"
[0m14:06:52.304095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:52.311534 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m14:06:52.312931 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:06:52.314034 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m14:06:52.329935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:52.334918 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category_province__dbt_backup"
[0m14:06:52.336762 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:06:52.337602 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category_province__dbt_backup" cascade
[0m14:06:52.338869 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:06:52.341697 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (execute): 14:06:52.190780 => 14:06:52.341228
[0m14:06:52.342558 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: Close
[0m14:06:52.344844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9324d49a20>]}
[0m14:06:52.347429 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.size_by_category_province ............. [[32mSELECT 72[0m in 0.17s]
[0m14:06:52.350337 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m14:06:52.351661 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_second_dbt_model
[0m14:06:52.352784 [info ] [Thread-1 (]: 8 of 8 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:06:52.354227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category_province, now model.data_challenge_dbt.my_second_dbt_model)
[0m14:06:52.355075 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_second_dbt_model
[0m14:06:52.360650 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_second_dbt_model"
[0m14:06:52.362012 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (compile): 14:06:52.355584 => 14:06:52.361471
[0m14:06:52.362886 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_second_dbt_model
[0m14:06:52.400384 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_second_dbt_model"
[0m14:06:52.401809 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:06:52.402694 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: BEGIN
[0m14:06:52.403499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:52.416845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:52.418471 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:06:52.419687 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */

  create view "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "data-challenge-dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:06:52.422672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:52.428532 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:06:52.429459 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:06:52.430975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:52.434259 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m14:06:52.435185 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:06:52.436004 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m14:06:52.463006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:52.470167 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup"
[0m14:06:52.475351 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:06:52.476345 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
drop view if exists "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:06:52.477803 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:52.480638 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (execute): 14:06:52.363418 => 14:06:52.480198
[0m14:06:52.481517 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: Close
[0m14:06:52.483723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7c64f0-23e5-454f-855d-f989db8ffd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9324d72fb0>]}
[0m14:06:52.486207 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:06:52.487550 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_second_dbt_model
[0m14:06:52.489753 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:52.490571 [debug] [MainThread]: On master: BEGIN
[0m14:06:52.491284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:52.504577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:52.505924 [debug] [MainThread]: On master: COMMIT
[0m14:06:52.507172 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:52.508257 [debug] [MainThread]: On master: COMMIT
[0m14:06:52.509355 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:52.510218 [debug] [MainThread]: On master: Close
[0m14:06:52.512057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:52.513604 [debug] [MainThread]: Connection 'model.data_challenge_dbt.my_second_dbt_model' was properly closed.
[0m14:06:52.516102 [info ] [MainThread]: 
[0m14:06:52.517945 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m14:06:52.522296 [debug] [MainThread]: Command end result
[0m14:06:52.538373 [info ] [MainThread]: 
[0m14:06:52.539324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:52.540142 [info ] [MainThread]: 
[0m14:06:52.540974 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:06:52.542589 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6684995, "process_user_time": 5.423936, "process_kernel_time": 0.175738, "process_mem_max_rss": "111616", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m14:06:52.543840 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:52.543415 after 2.67 seconds
[0m14:06:52.545193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9328915510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93259f3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93259f0f10>]}
[0m14:06:52.547079 [debug] [MainThread]: Flushing usage events
[0m14:11:51.290908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9d57bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9b591de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9b591d80>]}


============================== 14:11:51.295417 | c4c854b2-cfe5-4ba4-8003-3ba078607575 ==============================
[0m14:11:51.295417 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:11:51.296509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:51.607260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9bf68490>]}
[0m14:11:51.779774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9b41aa10>]}
[0m14:11:51.781098 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m14:11:51.795207 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:11:51.848995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:11:51.850377 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category_province.sql
[0m14:11:51.851380 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category.sql
[0m14:11:52.263288 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m14:11:52.273012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99ff0160>]}
[0m14:11:52.293754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a35fdc0>]}
[0m14:11:52.294942 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:11:52.295914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a35ff10>]}
[0m14:11:52.299721 [info ] [MainThread]: 
[0m14:11:52.301298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:52.303943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m14:11:52.322217 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m14:11:52.323559 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:11:52.324452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:52.340753 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:11:52.342987 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m14:11:52.347682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m14:11:52.358882 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m14:11:52.359744 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m14:11:52.360453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:52.373684 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:11:52.374554 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m14:11:52.375336 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:52.380428 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:11:52.382758 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m14:11:52.383949 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m14:11:52.394406 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:52.395206 [debug] [MainThread]: On master: BEGIN
[0m14:11:52.395880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:52.408893 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:52.409882 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:52.411854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:52.428641 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:11:52.431309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9ae9e860>]}
[0m14:11:52.432193 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:52.433201 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:52.433972 [debug] [MainThread]: On master: BEGIN
[0m14:11:52.435328 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:52.436578 [debug] [MainThread]: On master: COMMIT
[0m14:11:52.437768 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:52.438943 [debug] [MainThread]: On master: COMMIT
[0m14:11:52.440430 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:11:52.441647 [debug] [MainThread]: On master: Close
[0m14:11:52.443104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:52.444097 [info ] [MainThread]: 
[0m14:11:52.448329 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m14:11:52.449431 [info ] [Thread-1 (]: 1 of 8 START sql table model public.bibliotecas ................................ [RUN]
[0m14:11:52.451016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m14:11:52.451895 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m14:11:52.466948 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m14:11:52.468344 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 14:11:52.452411 => 14:11:52.467840
[0m14:11:52.469273 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m14:11:52.543596 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m14:11:52.544989 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:11:52.545886 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m14:11:52.546715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:52.560230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:52.561159 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:11:52.562042 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "domicilio" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca
  );
  
[0m14:11:52.606846 [debug] [Thread-1 (]: SQL status: SELECT 1902 in 0.0 seconds
[0m14:11:52.619484 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:11:52.620609 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
alter table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp" rename to "bibliotecas"
[0m14:11:52.622343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:52.656018 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m14:11:52.656972 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:11:52.657807 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m14:11:52.686987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:52.700189 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."bibliotecas__dbt_backup"
[0m14:11:52.708701 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m14:11:52.709657 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
drop table if exists "data-challenge-dbt"."public"."bibliotecas__dbt_backup" cascade
[0m14:11:52.710980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:11:52.713878 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 14:11:52.469839 => 14:11:52.713392
[0m14:11:52.714759 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m14:11:52.716298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99bc5600>]}
[0m14:11:52.717632 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.bibliotecas ........................... [[32mSELECT 1902[0m in 0.27s]
[0m14:11:52.719153 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m14:11:52.720118 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m14:11:52.721195 [info ] [Thread-1 (]: 2 of 8 START sql table model public.cines ...................................... [RUN]
[0m14:11:52.722600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m14:11:52.723451 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m14:11:52.728594 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m14:11:52.730021 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 14:11:52.723954 => 14:11:52.729453
[0m14:11:52.731038 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m14:11:52.739343 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m14:11:52.740599 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:11:52.741410 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m14:11:52.742193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:52.756732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:52.757793 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:11:52.758665 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine
  );
  
[0m14:11:52.815689 [debug] [Thread-1 (]: SQL status: SELECT 316 in 0.0 seconds
[0m14:11:52.827823 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:11:52.829820 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
alter table "data-challenge-dbt"."public"."cines__dbt_tmp" rename to "cines"
[0m14:11:52.832750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:52.841051 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m14:11:52.843011 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:11:52.844671 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m14:11:52.865924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:52.871758 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines__dbt_backup"
[0m14:11:52.873863 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m14:11:52.874826 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
drop table if exists "data-challenge-dbt"."public"."cines__dbt_backup" cascade
[0m14:11:52.876253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:11:52.879340 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 14:11:52.731605 => 14:11:52.878853
[0m14:11:52.880302 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m14:11:52.882169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a3ad6f0>]}
[0m14:11:52.883611 [info ] [Thread-1 (]: 2 of 8 OK created sql table model public.cines ................................. [[32mSELECT 316[0m in 0.16s]
[0m14:11:52.885232 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m14:11:52.886415 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m14:11:52.887990 [info ] [Thread-1 (]: 3 of 8 START sql table model public.cines_insights ............................. [RUN]
[0m14:11:52.889674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m14:11:52.890590 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m14:11:52.895561 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m14:11:52.897034 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 14:11:52.891099 => 14:11:52.896482
[0m14:11:52.897924 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m14:11:52.906867 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m14:11:52.908116 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:11:52.909027 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m14:11:52.909838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:52.925177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:52.926560 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:11:52.927453 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantallas") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m14:11:52.970298 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m14:11:52.982482 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:11:52.984037 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
alter table "data-challenge-dbt"."public"."cines_insights__dbt_tmp" rename to "cines_insights"
[0m14:11:52.986516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:52.993114 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m14:11:52.994686 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:11:52.996066 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m14:11:53.022061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:53.033037 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines_insights__dbt_backup"
[0m14:11:53.037344 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m14:11:53.039411 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
drop table if exists "data-challenge-dbt"."public"."cines_insights__dbt_backup" cascade
[0m14:11:53.042260 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:11:53.047518 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 14:11:52.898440 => 14:11:53.046842
[0m14:11:53.048905 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m14:11:53.051848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9975ca30>]}
[0m14:11:53.054936 [info ] [Thread-1 (]: 3 of 8 OK created sql table model public.cines_insights ........................ [[32mSELECT 24[0m in 0.16s]
[0m14:11:53.056631 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m14:11:53.057572 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m14:11:53.058669 [info ] [Thread-1 (]: 4 of 8 START sql table model public.museos ..................................... [RUN]
[0m14:11:53.060036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m14:11:53.060882 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m14:11:53.065937 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m14:11:53.067395 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 14:11:53.061381 => 14:11:53.066852
[0m14:11:53.068491 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m14:11:53.076840 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m14:11:53.078073 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:11:53.078913 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m14:11:53.079691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:53.094231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:53.095156 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:11:53.095999 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo
  );
  
[0m14:11:53.154306 [debug] [Thread-1 (]: SQL status: SELECT 1182 in 0.0 seconds
[0m14:11:53.166490 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:11:53.168385 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
alter table "data-challenge-dbt"."public"."museos__dbt_tmp" rename to "museos"
[0m14:11:53.171172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:53.179127 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m14:11:53.180854 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:11:53.182083 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m14:11:53.202153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:53.212093 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."museos__dbt_backup"
[0m14:11:53.215833 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m14:11:53.217505 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
drop table if exists "data-challenge-dbt"."public"."museos__dbt_backup" cascade
[0m14:11:53.219946 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:11:53.224493 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 14:11:53.069127 => 14:11:53.223681
[0m14:11:53.225807 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m14:11:53.227576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9975c970>]}
[0m14:11:53.228938 [info ] [Thread-1 (]: 4 of 8 OK created sql table model public.museos ................................ [[32mSELECT 1182[0m in 0.17s]
[0m14:11:53.230604 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m14:11:53.231571 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_first_dbt_model
[0m14:11:53.232810 [info ] [Thread-1 (]: 5 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:11:53.234414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.my_first_dbt_model)
[0m14:11:53.235282 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_first_dbt_model
[0m14:11:53.240249 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.241740 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (compile): 14:11:53.235793 => 14:11:53.241159
[0m14:11:53.242805 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_first_dbt_model
[0m14:11:53.252601 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.253887 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.254714 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: BEGIN
[0m14:11:53.255461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:53.272635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:53.274258 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.275923 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */

  
    

  create  table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:11:53.279251 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:11:53.289645 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.290976 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:11:53.292402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:53.298090 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.299015 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:11:53.300449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:53.308130 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m14:11:53.309079 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.309926 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m14:11:53.323517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:53.328950 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup"
[0m14:11:53.330861 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m14:11:53.331742 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
drop table if exists "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:11:53.346415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:11:53.349268 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (execute): 14:11:53.243386 => 14:11:53.348825
[0m14:11:53.350156 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: Close
[0m14:11:53.351701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99b2e740>]}
[0m14:11:53.352991 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m14:11:53.354509 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_first_dbt_model
[0m14:11:53.355474 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m14:11:53.356646 [info ] [Thread-1 (]: 6 of 8 START sql table model public.size_by_category ........................... [RUN]
[0m14:11:53.358209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.my_first_dbt_model, now model.data_challenge_dbt.size_by_category)
[0m14:11:53.359072 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m14:11:53.364000 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m14:11:53.365470 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 14:11:53.359569 => 14:11:53.364917
[0m14:11:53.366468 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m14:11:53.374628 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m14:11:53.375841 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:11:53.376708 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m14:11:53.377488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:53.393518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:53.394455 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:11:53.395355 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH categorias AS (
    SELECT categoria FROM cines
    UNION
    SELECT categoria FROM museos
    UNION
    SELECT categoria FROM bibliotecas
)

SELECT
    categoria,
    COUNT(*) AS cantidad
FROM categorias
GROUP BY categoria
  );
  
[0m14:11:53.440611 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m14:11:53.448936 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:11:53.450410 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
alter table "data-challenge-dbt"."public"."size_by_category__dbt_tmp" rename to "size_by_category"
[0m14:11:53.452398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:53.457993 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m14:11:53.459245 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:11:53.460386 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m14:11:53.479339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:53.484926 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category__dbt_backup"
[0m14:11:53.487230 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m14:11:53.488184 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category__dbt_backup" cascade
[0m14:11:53.489617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:11:53.492669 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 14:11:53.367033 => 14:11:53.492181
[0m14:11:53.493748 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m14:11:53.496127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99783370>]}
[0m14:11:53.498977 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.size_by_category ...................... [[32mSELECT 3[0m in 0.14s]
[0m14:11:53.500530 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m14:11:53.501451 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m14:11:53.502545 [info ] [Thread-1 (]: 7 of 8 START sql table model public.size_by_category_province .................. [RUN]
[0m14:11:53.503931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category, now model.data_challenge_dbt.size_by_category_province)
[0m14:11:53.504775 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category_province
[0m14:11:53.512803 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category_province"
[0m14:11:53.514155 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (compile): 14:11:53.505273 => 14:11:53.513651
[0m14:11:53.514976 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category_province
[0m14:11:53.523567 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category_province"
[0m14:11:53.524804 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:11:53.525928 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: BEGIN
[0m14:11:53.527760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:53.543471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:53.544428 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:11:53.545381 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp"
  
  
    as
  
  (
    

WITH categorias AS (
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."cines"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."museos"
    UNION
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."bibliotecas"
)

SELECT
    categoria,
    provincia,
    COUNT(*) AS cantidad
FROM categorias
GROUP BY categoria, provincia
  );
  
[0m14:11:53.599432 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.0 seconds
[0m14:11:53.611879 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:11:53.613919 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
alter table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp" rename to "size_by_category_province"
[0m14:11:53.616922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:53.624935 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m14:11:53.626669 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:11:53.627930 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m14:11:53.646752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:53.652519 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category_province__dbt_backup"
[0m14:11:53.654988 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m14:11:53.656024 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category_province__dbt_backup" cascade
[0m14:11:53.657834 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:11:53.661112 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (execute): 14:11:53.515484 => 14:11:53.660592
[0m14:11:53.662151 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: Close
[0m14:11:53.664621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99ff3f10>]}
[0m14:11:53.667266 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.size_by_category_province ............. [[32mSELECT 72[0m in 0.16s]
[0m14:11:53.668693 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m14:11:53.669760 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_second_dbt_model
[0m14:11:53.670822 [info ] [Thread-1 (]: 8 of 8 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:11:53.672198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category_province, now model.data_challenge_dbt.my_second_dbt_model)
[0m14:11:53.673431 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_second_dbt_model
[0m14:11:53.678681 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_second_dbt_model"
[0m14:11:53.680571 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (compile): 14:11:53.674140 => 14:11:53.679855
[0m14:11:53.681672 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_second_dbt_model
[0m14:11:53.720858 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_second_dbt_model"
[0m14:11:53.722135 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:11:53.722970 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: BEGIN
[0m14:11:53.723773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:53.737697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:53.739229 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:11:53.740467 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */

  create view "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "data-challenge-dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:11:53.743504 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:11:53.749634 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:11:53.750528 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:11:53.752052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:11:53.755358 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m14:11:53.756333 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:11:53.757204 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m14:11:53.779460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:11:53.786680 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup"
[0m14:11:53.792150 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m14:11:53.793077 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
drop view if exists "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:11:53.794406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:11:53.797238 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (execute): 14:11:53.682212 => 14:11:53.796790
[0m14:11:53.798123 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: Close
[0m14:11:53.799627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4c854b2-cfe5-4ba4-8003-3ba078607575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba997a8760>]}
[0m14:11:53.800874 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:11:53.802413 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_second_dbt_model
[0m14:11:53.804894 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:53.805853 [debug] [MainThread]: On master: BEGIN
[0m14:11:53.806580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:53.819835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:53.821030 [debug] [MainThread]: On master: COMMIT
[0m14:11:53.821834 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:53.822603 [debug] [MainThread]: On master: COMMIT
[0m14:11:53.824575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:11:53.825799 [debug] [MainThread]: On master: Close
[0m14:11:53.827650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:53.829238 [debug] [MainThread]: Connection 'model.data_challenge_dbt.my_second_dbt_model' was properly closed.
[0m14:11:53.830687 [info ] [MainThread]: 
[0m14:11:53.831534 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m14:11:53.836877 [debug] [MainThread]: Command end result
[0m14:11:53.853832 [info ] [MainThread]: 
[0m14:11:53.854739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:53.855536 [info ] [MainThread]: 
[0m14:11:53.856321 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:11:53.858065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.648793, "process_user_time": 5.396615, "process_kernel_time": 0.212496, "process_mem_max_rss": "111484", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m14:11:53.859414 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:53.859003 after 2.65 seconds
[0m14:11:53.860626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9d57bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99bc5600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9bf68490>]}
[0m14:11:53.862349 [debug] [MainThread]: Flushing usage events
[0m20:26:15.393110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93032fffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93013a5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93013a5cf0>]}


============================== 20:26:15.397625 | b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf ==============================
[0m20:26:15.397625 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:26:15.398813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/agustin/.dbt', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:26:15.713003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9301d5c400>]}
[0m20:26:15.887422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9301233490>]}
[0m20:26:15.888768 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m20:26:15.902073 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:26:15.957783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:26:15.959110 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category_province.sql
[0m20:26:15.960078 [debug] [MainThread]: Partial parsing: updated file: data_challenge_dbt://data_challenge_dbt/models/challenge/size_by_category.sql
[0m20:26:16.373167 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m20:26:16.382911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ffb08160>]}
[0m20:26:16.405733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9300377df0>]}
[0m20:26:16.406841 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:26:16.407693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9300377fd0>]}
[0m20:26:16.411065 [info ] [MainThread]: 
[0m20:26:16.412587 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:16.415217 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m20:26:16.435327 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m20:26:16.436441 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:26:16.437196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:16.452775 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:26:16.455087 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m20:26:16.459591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m20:26:16.470809 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m20:26:16.471678 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m20:26:16.472365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:16.485738 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:26:16.487061 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m20:26:16.488476 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:26:16.494092 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:26:16.496421 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m20:26:16.497534 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m20:26:16.508144 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:16.508955 [debug] [MainThread]: On master: BEGIN
[0m20:26:16.509652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:16.522890 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:16.523808 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:16.525111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:16.540056 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:26:16.542797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93003adcf0>]}
[0m20:26:16.543734 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:16.544875 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:16.545703 [debug] [MainThread]: On master: BEGIN
[0m20:26:16.547081 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:16.547865 [debug] [MainThread]: On master: COMMIT
[0m20:26:16.548565 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:16.549239 [debug] [MainThread]: On master: COMMIT
[0m20:26:16.550308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:26:16.551064 [debug] [MainThread]: On master: Close
[0m20:26:16.552988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:16.554763 [info ] [MainThread]: 
[0m20:26:16.559203 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m20:26:16.560334 [info ] [Thread-1 (]: 1 of 8 START sql table model public.bibliotecas ................................ [RUN]
[0m20:26:16.561964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m20:26:16.562875 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m20:26:16.577557 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m20:26:16.578982 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 20:26:16.563407 => 20:26:16.578472
[0m20:26:16.579848 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m20:26:16.649750 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m20:26:16.651115 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m20:26:16.652006 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m20:26:16.652826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:16.667571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:16.668468 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m20:26:16.669316 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "domicilio" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca
  );
  
[0m20:26:16.729538 [debug] [Thread-1 (]: SQL status: SELECT 1902 in 0.0 seconds
[0m20:26:16.749510 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m20:26:16.750739 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
alter table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp" rename to "bibliotecas"
[0m20:26:16.752639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:16.784664 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m20:26:16.785613 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m20:26:16.786423 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m20:26:16.799020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:16.812387 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."bibliotecas__dbt_backup"
[0m20:26:16.820821 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m20:26:16.821820 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
drop table if exists "data-challenge-dbt"."public"."bibliotecas__dbt_backup" cascade
[0m20:26:16.823205 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:16.826102 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 20:26:16.580361 => 20:26:16.825640
[0m20:26:16.826950 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m20:26:16.829070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ff704430>]}
[0m20:26:16.831591 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.bibliotecas ........................... [[32mSELECT 1902[0m in 0.27s]
[0m20:26:16.832991 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m20:26:16.833958 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m20:26:16.835056 [info ] [Thread-1 (]: 2 of 8 START sql table model public.cines ...................................... [RUN]
[0m20:26:16.836432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m20:26:16.837266 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m20:26:16.842513 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m20:26:16.844006 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 20:26:16.837807 => 20:26:16.843459
[0m20:26:16.845058 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m20:26:16.854016 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m20:26:16.855281 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m20:26:16.856147 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m20:26:16.856952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:16.871551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:16.872502 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m20:26:16.873395 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine
  );
  
[0m20:26:16.923141 [debug] [Thread-1 (]: SQL status: SELECT 316 in 0.0 seconds
[0m20:26:16.933380 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m20:26:16.934952 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
alter table "data-challenge-dbt"."public"."cines__dbt_tmp" rename to "cines"
[0m20:26:16.937410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:16.944069 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m20:26:16.945618 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m20:26:16.947027 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m20:26:16.966917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:16.973603 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines__dbt_backup"
[0m20:26:16.976059 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m20:26:16.977186 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
drop table if exists "data-challenge-dbt"."public"."cines__dbt_backup" cascade
[0m20:26:16.979188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:16.984127 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 20:26:16.845667 => 20:26:16.983651
[0m20:26:16.985032 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m20:26:16.987395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93003952a0>]}
[0m20:26:16.990030 [info ] [Thread-1 (]: 2 of 8 OK created sql table model public.cines ................................. [[32mSELECT 316[0m in 0.15s]
[0m20:26:16.991898 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m20:26:16.993208 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m20:26:16.994319 [info ] [Thread-1 (]: 3 of 8 START sql table model public.cines_insights ............................. [RUN]
[0m20:26:16.995756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m20:26:16.996603 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m20:26:17.002023 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m20:26:17.003533 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 20:26:16.997110 => 20:26:17.002966
[0m20:26:17.004417 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m20:26:17.013418 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m20:26:17.014730 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m20:26:17.015615 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m20:26:17.016434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:17.031791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:17.033373 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m20:26:17.035077 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantallas") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m20:26:17.090347 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m20:26:17.107105 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m20:26:17.109036 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
alter table "data-challenge-dbt"."public"."cines_insights__dbt_tmp" rename to "cines_insights"
[0m20:26:17.112328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:17.118328 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m20:26:17.119411 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m20:26:17.120383 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m20:26:17.144737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:17.149794 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines_insights__dbt_backup"
[0m20:26:17.151683 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m20:26:17.152550 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
drop table if exists "data-challenge-dbt"."public"."cines_insights__dbt_backup" cascade
[0m20:26:17.153873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:17.157057 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 20:26:17.004934 => 20:26:17.156436
[0m20:26:17.158772 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m20:26:17.160613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ff7749a0>]}
[0m20:26:17.162074 [info ] [Thread-1 (]: 3 of 8 OK created sql table model public.cines_insights ........................ [[32mSELECT 24[0m in 0.17s]
[0m20:26:17.164205 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m20:26:17.165318 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m20:26:17.166411 [info ] [Thread-1 (]: 4 of 8 START sql table model public.museos ..................................... [RUN]
[0m20:26:17.167796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m20:26:17.168669 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m20:26:17.174153 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m20:26:17.175808 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 20:26:17.169188 => 20:26:17.175235
[0m20:26:17.176683 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m20:26:17.185200 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m20:26:17.186449 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m20:26:17.187271 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m20:26:17.188028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:17.203751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:17.204662 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m20:26:17.205672 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo
  );
  
[0m20:26:17.265062 [debug] [Thread-1 (]: SQL status: SELECT 1182 in 0.0 seconds
[0m20:26:17.277390 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m20:26:17.279404 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
alter table "data-challenge-dbt"."public"."museos__dbt_tmp" rename to "museos"
[0m20:26:17.282423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:17.290363 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m20:26:17.292102 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m20:26:17.293672 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m20:26:17.313910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:17.321142 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."museos__dbt_backup"
[0m20:26:17.323953 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m20:26:17.325167 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
drop table if exists "data-challenge-dbt"."public"."museos__dbt_backup" cascade
[0m20:26:17.326964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:17.330910 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 20:26:17.177187 => 20:26:17.330276
[0m20:26:17.332127 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m20:26:17.335206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ff7748e0>]}
[0m20:26:17.336675 [info ] [Thread-1 (]: 4 of 8 OK created sql table model public.museos ................................ [[32mSELECT 1182[0m in 0.17s]
[0m20:26:17.338386 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m20:26:17.339354 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_first_dbt_model
[0m20:26:17.340531 [info ] [Thread-1 (]: 5 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:26:17.342221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.my_first_dbt_model)
[0m20:26:17.343138 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_first_dbt_model
[0m20:26:17.348219 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.349854 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (compile): 20:26:17.343664 => 20:26:17.349102
[0m20:26:17.350918 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_first_dbt_model
[0m20:26:17.360529 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.361901 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.362792 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: BEGIN
[0m20:26:17.363638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:17.379210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:17.380493 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.381357 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */

  
    

  create  table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:26:17.384189 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:26:17.392387 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.393346 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:26:17.394842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:17.400756 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.401807 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:26:17.403368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:17.411061 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m20:26:17.411981 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.412768 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: COMMIT
[0m20:26:17.435990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:17.446307 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup"
[0m20:26:17.449516 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_first_dbt_model"
[0m20:26:17.450723 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_first_dbt_model"} */
drop table if exists "data-challenge-dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:26:17.458753 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:17.461910 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_first_dbt_model (execute): 20:26:17.351468 => 20:26:17.461361
[0m20:26:17.462843 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_first_dbt_model: Close
[0m20:26:17.464537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ffbdb190>]}
[0m20:26:17.465955 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.12s]
[0m20:26:17.467588 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_first_dbt_model
[0m20:26:17.468643 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m20:26:17.469937 [info ] [Thread-1 (]: 6 of 8 START sql table model public.size_by_category ........................... [RUN]
[0m20:26:17.471405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.my_first_dbt_model, now model.data_challenge_dbt.size_by_category)
[0m20:26:17.472280 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m20:26:17.477215 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m20:26:17.478798 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 20:26:17.472806 => 20:26:17.478237
[0m20:26:17.479802 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m20:26:17.488098 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m20:26:17.489337 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m20:26:17.490237 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m20:26:17.491086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:17.506070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:17.507268 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m20:26:17.508801 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH categorias AS (
    SELECT categoria FROM cines
    UNION ALL
    SELECT categoria FROM museos
    UNION ALL
    SELECT categoria FROM bibliotecas
)

SELECT
    categoria,
    COUNT(*) AS cantidad
FROM categorias
GROUP BY categoria
  );
  
[0m20:26:17.563734 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m20:26:17.576764 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m20:26:17.578823 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
alter table "data-challenge-dbt"."public"."size_by_category__dbt_tmp" rename to "size_by_category"
[0m20:26:17.581785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:17.593507 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m20:26:17.594882 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m20:26:17.596149 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m20:26:17.602929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:17.608744 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category__dbt_backup"
[0m20:26:17.610807 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m20:26:17.611681 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category__dbt_backup" cascade
[0m20:26:17.613019 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:17.615904 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 20:26:17.480410 => 20:26:17.615450
[0m20:26:17.616790 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m20:26:17.618992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ff7c32e0>]}
[0m20:26:17.621576 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.size_by_category ...................... [[32mSELECT 3[0m in 0.15s]
[0m20:26:17.623008 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m20:26:17.623950 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m20:26:17.625036 [info ] [Thread-1 (]: 7 of 8 START sql table model public.size_by_category_province .................. [RUN]
[0m20:26:17.626528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category, now model.data_challenge_dbt.size_by_category_province)
[0m20:26:17.627367 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category_province
[0m20:26:17.636103 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category_province"
[0m20:26:17.637660 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (compile): 20:26:17.627887 => 20:26:17.637084
[0m20:26:17.638508 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category_province
[0m20:26:17.647968 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category_province"
[0m20:26:17.649701 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m20:26:17.650829 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: BEGIN
[0m20:26:17.651666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:17.666404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:17.667353 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m20:26:17.668223 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp"
  
  
    as
  
  (
    

WITH categorias AS (
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."cines"
    UNION ALL
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."museos"
    UNION ALL
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."bibliotecas"
)

SELECT
    categoria,
    provincia,
    COUNT(*) AS cantidad
FROM categorias
GROUP BY categoria, provincia
  );
  
[0m20:26:17.718055 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.0 seconds
[0m20:26:17.729475 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m20:26:17.731543 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
alter table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp" rename to "size_by_category_province"
[0m20:26:17.734569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:17.742753 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m20:26:17.744731 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m20:26:17.746748 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m20:26:17.770342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:17.778551 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category_province__dbt_backup"
[0m20:26:17.781455 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m20:26:17.782832 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category_province__dbt_backup" cascade
[0m20:26:17.784757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:17.789095 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (execute): 20:26:17.639017 => 20:26:17.788409
[0m20:26:17.790469 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: Close
[0m20:26:17.793784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9300394a30>]}
[0m20:26:17.797037 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.size_by_category_province ............. [[32mSELECT 72[0m in 0.17s]
[0m20:26:17.798761 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m20:26:17.799712 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.my_second_dbt_model
[0m20:26:17.800877 [info ] [Thread-1 (]: 8 of 8 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:26:17.802333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category_province, now model.data_challenge_dbt.my_second_dbt_model)
[0m20:26:17.803280 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.my_second_dbt_model
[0m20:26:17.808341 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.my_second_dbt_model"
[0m20:26:17.810320 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (compile): 20:26:17.803804 => 20:26:17.809536
[0m20:26:17.811549 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.my_second_dbt_model
[0m20:26:17.848995 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.my_second_dbt_model"
[0m20:26:17.850296 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m20:26:17.851166 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: BEGIN
[0m20:26:17.851982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:17.867398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:17.868989 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m20:26:17.870179 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */

  create view "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "data-challenge-dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:26:17.873318 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:26:17.879488 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m20:26:17.880448 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
alter table "data-challenge-dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:26:17.882003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:17.885275 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m20:26:17.886237 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m20:26:17.887112 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: COMMIT
[0m20:26:17.903723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:17.910798 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup"
[0m20:26:17.915990 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.my_second_dbt_model"
[0m20:26:17.916994 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.my_second_dbt_model"} */
drop view if exists "data-challenge-dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:26:17.918388 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:26:17.921267 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.my_second_dbt_model (execute): 20:26:17.812108 => 20:26:17.920814
[0m20:26:17.922196 [debug] [Thread-1 (]: On model.data_challenge_dbt.my_second_dbt_model: Close
[0m20:26:17.924398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f8fcb2-ffe3-44a5-acd5-e5cbd64b3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ff7d16f0>]}
[0m20:26:17.926979 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:26:17.928364 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.my_second_dbt_model
[0m20:26:17.931161 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:17.932325 [debug] [MainThread]: On master: BEGIN
[0m20:26:17.933031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:17.947238 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:17.948541 [debug] [MainThread]: On master: COMMIT
[0m20:26:17.949376 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:17.950227 [debug] [MainThread]: On master: COMMIT
[0m20:26:17.951363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:26:17.952293 [debug] [MainThread]: On master: Close
[0m20:26:17.953930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:17.954750 [debug] [MainThread]: Connection 'model.data_challenge_dbt.my_second_dbt_model' was properly closed.
[0m20:26:17.955605 [info ] [MainThread]: 
[0m20:26:17.956627 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m20:26:17.960677 [debug] [MainThread]: Command end result
[0m20:26:17.977888 [info ] [MainThread]: 
[0m20:26:17.978895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:17.979667 [info ] [MainThread]: 
[0m20:26:17.980472 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:26:17.981979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6718183, "process_user_time": 5.43618, "process_kernel_time": 0.23252, "process_mem_max_rss": "111576", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m20:26:17.983100 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:17.982819 after 2.67 seconds
[0m20:26:17.983907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93032fffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9301233490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ff7f26e0>]}
[0m20:26:17.984760 [debug] [MainThread]: Flushing usage events
[0m11:54:26.761997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c90547fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8e591d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8e591cf0>]}


============================== 11:54:26.818164 | 82bb13a1-e51e-478e-93ff-1c930cf48595 ==============================
[0m11:54:26.818164 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:54:26.822756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/agustin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:28.205045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8ef5c400>]}
[0m11:54:28.402471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8db77550>]}
[0m11:54:28.431515 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m11:54:28.455066 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:54:28.490391 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:54:28.491307 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:54:28.492198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8df8d450>]}
[0m11:54:30.786556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m11:54:30.796064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8c75e080>]}
[0m11:54:30.840627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8e47d540>]}
[0m11:54:30.841597 [info ] [MainThread]: Found 6 models, 18 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:54:30.842385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8dea6bc0>]}
[0m11:54:30.846959 [info ] [MainThread]: 
[0m11:54:30.848948 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:54:30.852131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m11:54:30.873107 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m11:54:30.873943 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:54:30.874632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:31.020932 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:54:31.024971 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m11:54:31.030722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m11:54:31.042118 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m11:54:31.042996 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m11:54:31.043826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:31.050399 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.051671 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m11:54:31.052858 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:54:31.058359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:54:31.060496 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m11:54:31.061684 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m11:54:31.069977 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:31.070845 [debug] [MainThread]: On master: BEGIN
[0m11:54:31.071608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:31.077659 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.078901 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:31.080753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:54:31.087624 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:54:31.089759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8c75ffd0>]}
[0m11:54:31.090674 [debug] [MainThread]: On master: ROLLBACK
[0m11:54:31.091853 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:31.092641 [debug] [MainThread]: On master: BEGIN
[0m11:54:31.094073 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.094882 [debug] [MainThread]: On master: COMMIT
[0m11:54:31.095717 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:31.096468 [debug] [MainThread]: On master: COMMIT
[0m11:54:31.097623 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:54:31.098683 [debug] [MainThread]: On master: Close
[0m11:54:31.100612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:31.102298 [info ] [MainThread]: 
[0m11:54:31.137170 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m11:54:31.139856 [info ] [Thread-1 (]: 1 of 6 START sql table model public.bibliotecas ................................ [RUN]
[0m11:54:31.143337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m11:54:31.144867 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m11:54:31.160944 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m11:54:31.164073 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 11:54:31.145713 => 11:54:31.163113
[0m11:54:31.165386 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m11:54:31.235312 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m11:54:31.236883 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m11:54:31.237806 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m11:54:31.238609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:31.244786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.245740 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m11:54:31.246604 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "domicilio" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca
  );
  
[0m11:54:31.248235 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_biblioteca" does not exist
LINE 27: FROM raw_biblioteca
              ^

[0m11:54:31.249208 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: ROLLBACK
[0m11:54:31.250657 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 11:54:31.165973 => 11:54:31.250165
[0m11:54:31.251617 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m11:54:31.351245 [debug] [Thread-1 (]: Database Error in model bibliotecas (data_challenge_dbt/models/challenge/bibliotecas.sql)
  relation "raw_biblioteca" does not exist
  LINE 27: FROM raw_biblioteca
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/bibliotecas.sql
[0m11:54:31.353916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8c7d7010>]}
[0m11:54:31.357086 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model public.bibliotecas ....................... [[31mERROR[0m in 0.21s]
[0m11:54:31.360285 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m11:54:31.362460 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m11:54:31.365954 [info ] [Thread-1 (]: 2 of 6 START sql table model public.cines ...................................... [RUN]
[0m11:54:31.369635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m11:54:31.372382 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m11:54:31.383492 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m11:54:31.385624 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 11:54:31.373845 => 11:54:31.384649
[0m11:54:31.388148 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m11:54:31.399583 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m11:54:31.400886 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m11:54:31.401867 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m11:54:31.403728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:31.410448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.411337 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m11:54:31.412199 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine
  );
  
[0m11:54:31.414238 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_cine" does not exist
LINE 29: FROM raw_cine
              ^

[0m11:54:31.415528 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: ROLLBACK
[0m11:54:31.417206 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 11:54:31.389202 => 11:54:31.416697
[0m11:54:31.418069 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m11:54:31.420470 [debug] [Thread-1 (]: Database Error in model cines (data_challenge_dbt/models/challenge/cines.sql)
  relation "raw_cine" does not exist
  LINE 29: FROM raw_cine
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines.sql
[0m11:54:31.421660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8c7ec5b0>]}
[0m11:54:31.423021 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model public.cines ............................. [[31mERROR[0m in 0.05s]
[0m11:54:31.424413 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m11:54:31.425335 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m11:54:31.426499 [info ] [Thread-1 (]: 3 of 6 START sql table model public.cines_insights ............................. [RUN]
[0m11:54:31.428247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m11:54:31.429199 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m11:54:31.434238 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m11:54:31.435590 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 11:54:31.429718 => 11:54:31.435073
[0m11:54:31.436469 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m11:54:31.444550 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m11:54:31.445819 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m11:54:31.446627 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m11:54:31.447416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:31.455226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.456732 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m11:54:31.457940 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantallas") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m11:54:31.459806 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_cine" does not exist
LINE 19: FROM raw_cine
              ^

[0m11:54:31.460726 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: ROLLBACK
[0m11:54:31.462243 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 11:54:31.437020 => 11:54:31.461747
[0m11:54:31.463095 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m11:54:31.467804 [debug] [Thread-1 (]: Database Error in model cines_insights (data_challenge_dbt/models/challenge/cines_insights.sql)
  relation "raw_cine" does not exist
  LINE 19: FROM raw_cine
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines_insights.sql
[0m11:54:31.468900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8c7ee350>]}
[0m11:54:31.470802 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model public.cines_insights .................... [[31mERROR[0m in 0.04s]
[0m11:54:31.472295 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m11:54:31.473227 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m11:54:31.474294 [info ] [Thread-1 (]: 4 of 6 START sql table model public.museos ..................................... [RUN]
[0m11:54:31.475745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m11:54:31.476697 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m11:54:31.484712 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m11:54:31.486712 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 11:54:31.477314 => 11:54:31.485946
[0m11:54:31.487980 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m11:54:31.496087 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m11:54:31.497323 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m11:54:31.498217 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m11:54:31.499115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:31.505814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.507296 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m11:54:31.508864 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo
  );
  
[0m11:54:31.511267 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_museo" does not exist
LINE 27: FROM raw_museo
              ^

[0m11:54:31.512932 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: ROLLBACK
[0m11:54:31.514610 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 11:54:31.488512 => 11:54:31.514076
[0m11:54:31.515822 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m11:54:31.518411 [debug] [Thread-1 (]: Database Error in model museos (data_challenge_dbt/models/challenge/museos.sql)
  relation "raw_museo" does not exist
  LINE 27: FROM raw_museo
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/museos.sql
[0m11:54:31.519605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8c7ef310>]}
[0m11:54:31.520983 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model public.museos ............................ [[31mERROR[0m in 0.04s]
[0m11:54:31.522255 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m11:54:31.523163 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m11:54:31.524739 [info ] [Thread-1 (]: 5 of 6 START sql table model public.size_by_category ........................... [RUN]
[0m11:54:31.526675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.size_by_category)
[0m11:54:31.527889 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m11:54:31.533215 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m11:54:31.535334 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 11:54:31.528418 => 11:54:31.534487
[0m11:54:31.536675 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m11:54:31.545773 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m11:54:31.546994 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m11:54:31.547907 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m11:54:31.548957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:31.557891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.559795 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m11:54:31.560658 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH categorias AS (
    SELECT categoria FROM cines
    UNION ALL
    SELECT categoria FROM museos
    UNION ALL
    SELECT categoria FROM bibliotecas
)

SELECT
    categoria,
    COUNT(*) AS cantidad
FROM categorias
GROUP BY categoria
  );
  
[0m11:54:31.562265 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "cines" does not exist
LINE 15:     SELECT categoria FROM cines
                                   ^

[0m11:54:31.563138 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: ROLLBACK
[0m11:54:31.564802 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 11:54:31.537255 => 11:54:31.564299
[0m11:54:31.565710 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m11:54:31.570781 [debug] [Thread-1 (]: Database Error in model size_by_category (data_challenge_dbt/models/challenge/size_by_category.sql)
  relation "cines" does not exist
  LINE 15:     SELECT categoria FROM cines
                                     ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/size_by_category.sql
[0m11:54:31.571836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bb13a1-e51e-478e-93ff-1c930cf48595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8c3d7700>]}
[0m11:54:31.572983 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model public.size_by_category .................. [[31mERROR[0m in 0.05s]
[0m11:54:31.574291 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m11:54:31.575195 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m11:54:31.576236 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.size_by_category_province .......................... [[33mSKIP[0m]
[0m11:54:31.577337 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m11:54:31.580079 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:31.581246 [debug] [MainThread]: On master: BEGIN
[0m11:54:31.583243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:31.590277 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:31.591095 [debug] [MainThread]: On master: COMMIT
[0m11:54:31.591798 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:31.592465 [debug] [MainThread]: On master: COMMIT
[0m11:54:31.593419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:54:31.594258 [debug] [MainThread]: On master: Close
[0m11:54:31.596488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:31.597299 [debug] [MainThread]: Connection 'model.data_challenge_dbt.size_by_category' was properly closed.
[0m11:54:31.598103 [info ] [MainThread]: 
[0m11:54:31.599122 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m11:54:31.601820 [debug] [MainThread]: Command end result
[0m11:54:31.620014 [info ] [MainThread]: 
[0m11:54:31.620972 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m11:54:31.621775 [info ] [MainThread]: 
[0m11:54:31.622596 [error] [MainThread]:   Database Error in model bibliotecas (data_challenge_dbt/models/challenge/bibliotecas.sql)
  relation "raw_biblioteca" does not exist
  LINE 27: FROM raw_biblioteca
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/bibliotecas.sql
[0m11:54:31.623496 [info ] [MainThread]: 
[0m11:54:31.624407 [error] [MainThread]:   Database Error in model cines (data_challenge_dbt/models/challenge/cines.sql)
  relation "raw_cine" does not exist
  LINE 29: FROM raw_cine
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines.sql
[0m11:54:31.625192 [info ] [MainThread]: 
[0m11:54:31.625989 [error] [MainThread]:   Database Error in model cines_insights (data_challenge_dbt/models/challenge/cines_insights.sql)
  relation "raw_cine" does not exist
  LINE 19: FROM raw_cine
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/cines_insights.sql
[0m11:54:31.626881 [info ] [MainThread]: 
[0m11:54:31.628033 [error] [MainThread]:   Database Error in model museos (data_challenge_dbt/models/challenge/museos.sql)
  relation "raw_museo" does not exist
  LINE 27: FROM raw_museo
                ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/museos.sql
[0m11:54:31.629523 [info ] [MainThread]: 
[0m11:54:31.630860 [error] [MainThread]:   Database Error in model size_by_category (data_challenge_dbt/models/challenge/size_by_category.sql)
  relation "cines" does not exist
  LINE 15:     SELECT categoria FROM cines
                                     ^
  compiled Code at target/run/data_challenge_dbt/data_challenge_dbt/models/challenge/size_by_category.sql
[0m11:54:31.631872 [info ] [MainThread]: 
[0m11:54:31.632741 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=1 TOTAL=6
[0m11:54:31.634306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.015282, "process_user_time": 7.869228, "process_kernel_time": 0.700381, "process_mem_max_rss": "112488", "process_in_blocks": "58264", "process_out_blocks": "2800", "command_success": false}
[0m11:54:31.635449 [debug] [MainThread]: Command `dbt run` failed at 11:54:31.635170 after 5.02 seconds
[0m11:54:31.636332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c90547fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8df8c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c8cf4e140>]}
[0m11:54:31.637195 [debug] [MainThread]: Flushing usage events
[0m12:45:37.567726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e29ba3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e27e91d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e27e91cf0>]}


============================== 12:45:37.572401 | 40602fcc-da69-4db1-82fd-c1e317be0cc6 ==============================
[0m12:45:37.572401 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:45:37.573538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/agustin/Documentos/data-challenge-dbt/logs', 'profiles_dir': '/home/agustin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:37.896183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e28850400>]}
[0m12:45:38.079220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e27377550>]}
[0m12:45:38.080608 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m12:45:38.094842 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:45:38.147252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:38.148200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:38.150396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_challenge_dbt.challenge.size_by_categoty_province
[0m12:45:38.160728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26ba80d0>]}
[0m12:45:38.183214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26b5ecb0>]}
[0m12:45:38.184237 [info ] [MainThread]: Found 6 models, 18 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:45:38.185134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26b5ef20>]}
[0m12:45:38.188850 [info ] [MainThread]: 
[0m12:45:38.191165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:38.193640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data-challenge-dbt'
[0m12:45:38.214230 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt"
[0m12:45:38.215111 [debug] [ThreadPool]: On list_data-challenge-dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:45:38.216613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:38.225849 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:45:38.228205 [debug] [ThreadPool]: On list_data-challenge-dbt: Close
[0m12:45:38.231970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-challenge-dbt, now list_data-challenge-dbt_public)
[0m12:45:38.242682 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m12:45:38.243576 [debug] [ThreadPool]: On list_data-challenge-dbt_public: BEGIN
[0m12:45:38.244449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:38.250766 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:45:38.252138 [debug] [ThreadPool]: Using postgres connection "list_data-challenge-dbt_public"
[0m12:45:38.253252 [debug] [ThreadPool]: On list_data-challenge-dbt_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "list_data-challenge-dbt_public"} */
select
      'data-challenge-dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data-challenge-dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:45:38.258478 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:45:38.261022 [debug] [ThreadPool]: On list_data-challenge-dbt_public: ROLLBACK
[0m12:45:38.262144 [debug] [ThreadPool]: On list_data-challenge-dbt_public: Close
[0m12:45:38.273362 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:38.274139 [debug] [MainThread]: On master: BEGIN
[0m12:45:38.274781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:38.281603 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:38.282860 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:38.284211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:38.296772 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:45:38.298859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26bdf850>]}
[0m12:45:38.300018 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:38.301111 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:38.301889 [debug] [MainThread]: On master: BEGIN
[0m12:45:38.303264 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:38.304273 [debug] [MainThread]: On master: COMMIT
[0m12:45:38.305013 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:38.305834 [debug] [MainThread]: On master: COMMIT
[0m12:45:38.306821 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:38.307702 [debug] [MainThread]: On master: Close
[0m12:45:38.309239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:38.310206 [info ] [MainThread]: 
[0m12:45:38.314099 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.bibliotecas
[0m12:45:38.315149 [info ] [Thread-1 (]: 1 of 6 START sql table model public.bibliotecas ................................ [RUN]
[0m12:45:38.316714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-challenge-dbt_public, now model.data_challenge_dbt.bibliotecas)
[0m12:45:38.317593 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.bibliotecas
[0m12:45:38.332231 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.bibliotecas"
[0m12:45:38.333772 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (compile): 12:45:38.318097 => 12:45:38.333130
[0m12:45:38.334627 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.bibliotecas
[0m12:45:38.406842 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.bibliotecas"
[0m12:45:38.408332 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m12:45:38.409229 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: BEGIN
[0m12:45:38.409992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:38.416281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:38.417198 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m12:45:38.418051 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */

  
    

  create  table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp"
  
  
    as
  
  (
    

select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "domicilio" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "mail" as mail,
    "web" as web
FROM raw_biblioteca
  );
  
[0m12:45:38.468268 [debug] [Thread-1 (]: SQL status: SELECT 1902 in 0.0 seconds
[0m12:45:38.484189 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m12:45:38.485593 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
alter table "data-challenge-dbt"."public"."bibliotecas__dbt_tmp" rename to "bibliotecas"
[0m12:45:38.503531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:38.538654 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m12:45:38.539916 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m12:45:38.540831 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: COMMIT
[0m12:45:38.562393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:38.574671 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."bibliotecas__dbt_backup"
[0m12:45:38.583827 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.bibliotecas"
[0m12:45:38.584817 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.bibliotecas"} */
drop table if exists "data-challenge-dbt"."public"."bibliotecas__dbt_backup" cascade
[0m12:45:38.586188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:38.589331 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.bibliotecas (execute): 12:45:38.335155 => 12:45:38.588869
[0m12:45:38.590319 [debug] [Thread-1 (]: On model.data_challenge_dbt.bibliotecas: Close
[0m12:45:38.592700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26baaf80>]}
[0m12:45:38.595226 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.bibliotecas ........................... [[32mSELECT 1902[0m in 0.28s]
[0m12:45:38.596947 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.bibliotecas
[0m12:45:38.597880 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines
[0m12:45:38.598967 [info ] [Thread-1 (]: 2 of 6 START sql table model public.cines ...................................... [RUN]
[0m12:45:38.600414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.bibliotecas, now model.data_challenge_dbt.cines)
[0m12:45:38.601285 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines
[0m12:45:38.606715 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines"
[0m12:45:38.608213 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (compile): 12:45:38.601805 => 12:45:38.607577
[0m12:45:38.609400 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines
[0m12:45:38.617766 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines"
[0m12:45:38.619107 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m12:45:38.620206 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: BEGIN
[0m12:45:38.620992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:38.629035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:38.629990 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m12:45:38.630839 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */

  
    

  create  table "data-challenge-dbt"."public"."cines__dbt_tmp"
  
  
    as
  
  (
    -- Antes hay que crear las siguientes columnas: telefono y mail



select
    "cod_localidad" as cod_localidad,
    "id_provincia" as id_provincia,
    "id_departamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "cp" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    NULL as telefono,
    NULL as mail,
    "web" as web
FROM raw_cine
  );
  
[0m12:45:38.673198 [debug] [Thread-1 (]: SQL status: SELECT 316 in 0.0 seconds
[0m12:45:38.681673 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m12:45:38.683334 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
alter table "data-challenge-dbt"."public"."cines__dbt_tmp" rename to "cines"
[0m12:45:38.685486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:38.691615 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m12:45:38.692763 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m12:45:38.693844 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: COMMIT
[0m12:45:38.718378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:38.725662 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines__dbt_backup"
[0m12:45:38.727537 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines"
[0m12:45:38.728437 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines"} */
drop table if exists "data-challenge-dbt"."public"."cines__dbt_backup" cascade
[0m12:45:38.729722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:38.732678 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines (execute): 12:45:38.609962 => 12:45:38.732233
[0m12:45:38.733542 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines: Close
[0m12:45:38.735082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26793c40>]}
[0m12:45:38.736376 [info ] [Thread-1 (]: 2 of 6 OK created sql table model public.cines ................................. [[32mSELECT 316[0m in 0.14s]
[0m12:45:38.737879 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines
[0m12:45:38.738911 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.cines_insights
[0m12:45:38.740174 [info ] [Thread-1 (]: 3 of 6 START sql table model public.cines_insights ............................. [RUN]
[0m12:45:38.741574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines, now model.data_challenge_dbt.cines_insights)
[0m12:45:38.742435 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.cines_insights
[0m12:45:38.806233 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.cines_insights"
[0m12:45:38.807969 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (compile): 12:45:38.742939 => 12:45:38.807226
[0m12:45:38.808860 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.cines_insights
[0m12:45:38.817165 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.cines_insights"
[0m12:45:38.818641 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m12:45:38.819525 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: BEGIN
[0m12:45:38.820512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:38.827203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:38.828482 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m12:45:38.829374 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */

  
    

  create  table "data-challenge-dbt"."public"."cines_insights__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
"provincia" AS provincia,
SUM("pantallas") AS pantallas,
SUM("butacas") AS butacas,
COUNT(CASE WHEN "espacio_incaa" = 'Si' THEN 1 END) AS espacios_incaa
FROM raw_cine
GROUP BY "provincia"


/*
COLUMNAS raw_cine
'cod_localidad', 'id_provincia', 'id_departamento', 'categoria',
'provincia', 'departamento', 'localidad', 'nombre', 'direccion', 'piso',
'cp', 'web', 'latitud', 'longitud', 'tipo_latitud_longitud', 'fuente',
'sector', 'pantallas', 'butacas', 'tipo_de_gestion', 'espacio_incaa',
'año_actualizacion'
*/
  );
  
[0m12:45:38.886256 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m12:45:38.898804 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m12:45:38.901069 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
alter table "data-challenge-dbt"."public"."cines_insights__dbt_tmp" rename to "cines_insights"
[0m12:45:38.904130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:38.911193 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m12:45:38.912280 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m12:45:38.913167 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: COMMIT
[0m12:45:38.940571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:38.945618 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."cines_insights__dbt_backup"
[0m12:45:38.947409 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.cines_insights"
[0m12:45:38.948314 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.cines_insights"} */
drop table if exists "data-challenge-dbt"."public"."cines_insights__dbt_backup" cascade
[0m12:45:38.949593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:38.952499 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.cines_insights (execute): 12:45:38.809391 => 12:45:38.952053
[0m12:45:38.953364 [debug] [Thread-1 (]: On model.data_challenge_dbt.cines_insights: Close
[0m12:45:38.954935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26790880>]}
[0m12:45:38.957373 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.cines_insights ........................ [[32mSELECT 24[0m in 0.21s]
[0m12:45:38.959068 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.cines_insights
[0m12:45:38.960045 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.museos
[0m12:45:38.961228 [info ] [Thread-1 (]: 4 of 6 START sql table model public.museos ..................................... [RUN]
[0m12:45:38.962569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.cines_insights, now model.data_challenge_dbt.museos)
[0m12:45:38.963438 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.museos
[0m12:45:38.968691 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.museos"
[0m12:45:38.970310 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (compile): 12:45:38.964190 => 12:45:38.969592
[0m12:45:38.971815 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.museos
[0m12:45:38.980907 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.museos"
[0m12:45:38.982321 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m12:45:38.983159 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: BEGIN
[0m12:45:38.984018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:38.992020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:38.993001 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m12:45:38.993843 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */

  
    

  create  table "data-challenge-dbt"."public"."museos__dbt_tmp"
  
  
    as
  
  (
    

select
    "Cod_Loc" as cod_localidad,
    "IdProvincia" as id_provincia,
    "IdDepartamento" as id_departamento,
    "provincia" as provincia,
    "categoria" as categoria,
    "direccion" as domicilio,
    "CP" as codigo_postal,
    "localidad" as localidad,
    "nombre" as nombre,
    "telefono" as telefono,
    "Mail" as mail,
    "Web" as web
FROM raw_museo
  );
  
[0m12:45:39.060333 [debug] [Thread-1 (]: SQL status: SELECT 1182 in 0.0 seconds
[0m12:45:39.073472 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m12:45:39.075347 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
alter table "data-challenge-dbt"."public"."museos__dbt_tmp" rename to "museos"
[0m12:45:39.078702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:39.086959 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m12:45:39.088336 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m12:45:39.089655 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: COMMIT
[0m12:45:39.109836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:39.118110 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."museos__dbt_backup"
[0m12:45:39.120682 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.museos"
[0m12:45:39.122409 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.museos"} */
drop table if exists "data-challenge-dbt"."public"."museos__dbt_backup" cascade
[0m12:45:39.124711 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:39.128746 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.museos (execute): 12:45:38.972519 => 12:45:39.128306
[0m12:45:39.129620 [debug] [Thread-1 (]: On model.data_challenge_dbt.museos: Close
[0m12:45:39.131729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26729ba0>]}
[0m12:45:39.134229 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.museos ................................ [[32mSELECT 1182[0m in 0.17s]
[0m12:45:39.136037 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.museos
[0m12:45:39.136967 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category
[0m12:45:39.138056 [info ] [Thread-1 (]: 5 of 6 START sql table model public.size_by_category ........................... [RUN]
[0m12:45:39.139845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.museos, now model.data_challenge_dbt.size_by_category)
[0m12:45:39.140847 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category
[0m12:45:39.146065 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category"
[0m12:45:39.147952 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (compile): 12:45:39.141362 => 12:45:39.147103
[0m12:45:39.148885 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category
[0m12:45:39.157855 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category"
[0m12:45:39.159103 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m12:45:39.159958 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: BEGIN
[0m12:45:39.160741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:39.168141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:39.169102 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m12:45:39.169961 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH categorias AS (
    SELECT categoria FROM cines
    UNION ALL
    SELECT categoria FROM museos
    UNION ALL
    SELECT categoria FROM bibliotecas
)

SELECT
    categoria,
    COUNT(*) AS cantidad
FROM categorias
GROUP BY categoria
  );
  
[0m12:45:39.224392 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m12:45:39.237940 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m12:45:39.239972 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
alter table "data-challenge-dbt"."public"."size_by_category__dbt_tmp" rename to "size_by_category"
[0m12:45:39.243389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:39.250112 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m12:45:39.251462 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m12:45:39.252605 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: COMMIT
[0m12:45:39.276605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:39.281740 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category__dbt_backup"
[0m12:45:39.283595 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category"
[0m12:45:39.284491 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category__dbt_backup" cascade
[0m12:45:39.285875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:39.288744 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category (execute): 12:45:39.149389 => 12:45:39.288303
[0m12:45:39.289616 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category: Close
[0m12:45:39.291277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e2673ec20>]}
[0m12:45:39.292636 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.size_by_category ...................... [[32mSELECT 3[0m in 0.15s]
[0m12:45:39.294190 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category
[0m12:45:39.295166 [debug] [Thread-1 (]: Began running node model.data_challenge_dbt.size_by_category_province
[0m12:45:39.296246 [info ] [Thread-1 (]: 6 of 6 START sql table model public.size_by_category_province .................. [RUN]
[0m12:45:39.297981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_challenge_dbt.size_by_category, now model.data_challenge_dbt.size_by_category_province)
[0m12:45:39.299314 [debug] [Thread-1 (]: Began compiling node model.data_challenge_dbt.size_by_category_province
[0m12:45:39.306538 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_challenge_dbt.size_by_category_province"
[0m12:45:39.308263 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (compile): 12:45:39.299915 => 12:45:39.307488
[0m12:45:39.309154 [debug] [Thread-1 (]: Began executing node model.data_challenge_dbt.size_by_category_province
[0m12:45:39.318027 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_challenge_dbt.size_by_category_province"
[0m12:45:39.319581 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m12:45:39.320555 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: BEGIN
[0m12:45:39.321361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:39.329829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:39.331205 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m12:45:39.333570 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */

  
    

  create  table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp"
  
  
    as
  
  (
    

WITH categorias AS (
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."cines"
    UNION ALL
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."museos"
    UNION ALL
    SELECT categoria, provincia
    FROM "data-challenge-dbt"."public"."bibliotecas"
)

SELECT
    categoria,
    provincia,
    COUNT(*) AS cantidad
FROM categorias
GROUP BY categoria, provincia
  );
  
[0m12:45:39.402728 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.0 seconds
[0m12:45:39.422192 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m12:45:39.424317 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
alter table "data-challenge-dbt"."public"."size_by_category_province__dbt_tmp" rename to "size_by_category_province"
[0m12:45:39.427247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:39.434367 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m12:45:39.436226 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m12:45:39.437305 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: COMMIT
[0m12:45:39.454943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:39.460557 [debug] [Thread-1 (]: Applying DROP to: "data-challenge-dbt"."public"."size_by_category_province__dbt_backup"
[0m12:45:39.463144 [debug] [Thread-1 (]: Using postgres connection "model.data_challenge_dbt.size_by_category_province"
[0m12:45:39.464084 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_challenge_dbt", "target_name": "dev", "node_id": "model.data_challenge_dbt.size_by_category_province"} */
drop table if exists "data-challenge-dbt"."public"."size_by_category_province__dbt_backup" cascade
[0m12:45:39.465372 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:39.468541 [debug] [Thread-1 (]: Timing info for model.data_challenge_dbt.size_by_category_province (execute): 12:45:39.309679 => 12:45:39.468035
[0m12:45:39.469397 [debug] [Thread-1 (]: On model.data_challenge_dbt.size_by_category_province: Close
[0m12:45:39.470951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40602fcc-da69-4db1-82fd-c1e317be0cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26764640>]}
[0m12:45:39.472372 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.size_by_category_province ............. [[32mSELECT 72[0m in 0.17s]
[0m12:45:39.473904 [debug] [Thread-1 (]: Finished running node model.data_challenge_dbt.size_by_category_province
[0m12:45:39.476398 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:39.477194 [debug] [MainThread]: On master: BEGIN
[0m12:45:39.477869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:39.484033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:39.485180 [debug] [MainThread]: On master: COMMIT
[0m12:45:39.486234 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:39.486955 [debug] [MainThread]: On master: COMMIT
[0m12:45:39.487940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:39.488715 [debug] [MainThread]: On master: Close
[0m12:45:39.491136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:39.492656 [debug] [MainThread]: Connection 'model.data_challenge_dbt.size_by_category_province' was properly closed.
[0m12:45:39.494147 [info ] [MainThread]: 
[0m12:45:39.495418 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m12:45:39.498107 [debug] [MainThread]: Command end result
[0m12:45:39.514884 [info ] [MainThread]: 
[0m12:45:39.515872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:39.516711 [info ] [MainThread]: 
[0m12:45:39.517503 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:45:39.519283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.03692, "process_user_time": 4.994858, "process_kernel_time": 0.132181, "process_mem_max_rss": "106572", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m12:45:39.520631 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:39.520355 after 2.04 seconds
[0m12:45:39.521388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e29ba3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e267ae200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e26766260>]}
[0m12:45:39.522164 [debug] [MainThread]: Flushing usage events
